2025-06-02 20:36:25,671 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-02 20:36:25,671 - INFO - Configuration:
2025-06-02 20:36:25,671 - INFO -   frame_base_dir: ./sequence
2025-06-02 20:36:25,674 - INFO -   flow_base_dir: ./generated_flow
2025-06-02 20:36:25,674 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-02 20:36:25,674 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-02 20:36:25,674 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-02 20:36:25,675 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-02 20:36:25,675 - INFO -   motion_latent_channels: 128
2025-06-02 20:36:25,675 - INFO -   residual_latent_channels: 192
2025-06-02 20:36:25,675 - INFO -   mcn_base_channels: 32
2025-06-02 20:36:25,675 - INFO -   encoder_base_channels: 64
2025-06-02 20:36:25,676 - INFO -   encoder_res_blocks: 2
2025-06-02 20:36:25,676 - INFO -   encoder_downsample_layers: 3
2025-06-02 20:36:25,676 - INFO -   decoder_res_blocks: 2
2025-06-02 20:36:25,676 - INFO -   decoder_upsample_layers: 3
2025-06-02 20:36:25,676 - INFO -   epochs: 1000
2025-06-02 20:36:25,676 - INFO -   batch_size: 4
2025-06-02 20:36:25,676 - INFO -   learning_rate: 0.0001
2025-06-02 20:36:25,676 - INFO -   weight_decay: 1e-05
2025-06-02 20:36:25,676 - INFO -   clip_max_norm: 1.0
2025-06-02 20:36:25,676 - INFO -   seed: 42
2025-06-02 20:36:25,676 - INFO -   num_workers: 2
2025-06-02 20:36:25,677 - INFO -   use_amp: True
2025-06-02 20:36:25,677 - INFO -   bitstream_calc_freq: 200
2025-06-02 20:36:25,677 - INFO -   phase1_epochs: 30
2025-06-02 20:36:25,677 - INFO -   phase3_start_epoch: 97
2025-06-02 20:36:25,677 - INFO -   lambda_mse_flow: 10.0
2025-06-02 20:36:25,678 - INFO -   lambda_mse_residual: 10000.0
2025-06-02 20:36:25,678 - INFO -   lambda_bpp_motion: 1.0
2025-06-02 20:36:25,678 - INFO -   lambda_bpp_residual: 5.0
2025-06-02 20:36:25,678 - INFO -   lambda_msssim_phase3: 5.0
2025-06-02 20:36:25,678 - INFO -   learning_rate_phase3: 1e-05
2025-06-02 20:36:25,678 - INFO -   freeze_mcn_phase1: True
2025-06-02 20:36:25,679 - INFO -   device: cuda
2025-06-02 20:36:25,679 - INFO - ------------------------------------------------------------
2025-06-02 20:36:25,679 - INFO - Setting up dataset...
2025-06-02 20:36:25,679 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-02 20:36:26,096 - INFO - Found 21000 potential frame files.
2025-06-02 20:36:26,098 - INFO - Grouping frames by directory...
2025-06-02 20:36:26,188 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-02 20:36:27,064 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-02 20:36:27,073 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-02 20:36:27,073 - INFO - Initializing Video Codec model...
2025-06-02 20:36:27,338 - INFO - Using a single GPU or CPU.
2025-06-02 20:36:27,338 - INFO - Model initialized (29,938,216 total parameters).
2025-06-02 20:36:27,338 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 20:36:27,338 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 20:36:27,338 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-02 20:36:27,529 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-02 20:36:27,766 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-02 20:36:27,824 - INFO - Loading optimizer state...
2025-06-02 20:36:27,934 - INFO - Optimizer state loaded successfully.
2025-06-02 20:36:27,935 - INFO - Loading GradScaler state...
2025-06-02 20:36:27,935 - INFO - GradScaler state loaded successfully.
2025-06-02 20:36:27,935 - INFO - Checkpoint loaded. Resuming from Epoch 96. Optimizer mode was 'full'.
2025-06-02 20:36:27,936 - INFO - Resumed successfully. Training from Epoch 97. Optimizer mode was 'full'.
2025-06-02 20:36:27,938 - INFO - --- Starting Training Loop from Epoch 97 up to 1000 ---
2025-06-02 20:36:27,939 - INFO - 
-------------------- Starting Epoch 97/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 20:36:27,939 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-02 20:36:27,941 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-02 20:36:27,941 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-02 20:37:25,729 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 20:38:13,573 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 20:39:03,079 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 20:39:56,632 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 20:40:53,049 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 20:41:44,518 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 20:42:33,288 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 20:43:21,910 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 20:44:10,734 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 20:44:59,536 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 20:45:48,589 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 20:46:37,419 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 20:47:26,169 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 20:48:14,624 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 20:49:02,938 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 20:49:51,228 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 20:50:39,479 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 20:51:27,728 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 20:52:15,952 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 20:53:03,976 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 20:53:51,963 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 20:54:39,902 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 20:55:04,677 - INFO - ------------------------------------------------------------
2025-06-02 20:55:04,677 - INFO - Epoch 97/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1116.74s
2025-06-02 20:55:04,677 - INFO -   Avg Loss: 5.40311
2025-06-02 20:55:04,677 - INFO -   Avg MS-SSIM (opt): 0.97768
2025-06-02 20:55:04,677 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000400
2025-06-02 20:55:04,677 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.25793
2025-06-02 20:55:04,677 - INFO - ------------------------------------------------------------
2025-06-02 20:55:04,677 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 20:55:04,698 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 20:55:04,698 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 20:55:04,793 - ERROR - ERROR during visualization for Epoch 97: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 20:55:04,802 - INFO - 
-------------------- Starting Epoch 98/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 20:56:03,597 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 20:56:51,793 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 20:57:39,892 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 20:58:27,867 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 20:59:15,791 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 21:00:03,633 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 21:00:51,610 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 21:01:39,538 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 21:02:27,509 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 21:03:15,490 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 21:04:03,453 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 21:04:51,416 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 21:05:39,415 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 21:06:27,374 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 21:07:15,455 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 21:08:03,451 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 21:08:51,414 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 21:09:39,361 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 21:10:27,331 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 21:11:15,351 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 21:12:03,361 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 21:12:51,434 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 21:13:16,276 - INFO - ------------------------------------------------------------
2025-06-02 21:13:16,276 - INFO - Epoch 98/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.47s
2025-06-02 21:13:16,276 - INFO -   Avg Loss: 5.56331
2025-06-02 21:13:16,276 - INFO -   Avg MS-SSIM (opt): 0.97644
2025-06-02 21:13:16,276 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000401
2025-06-02 21:13:16,276 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.28737
2025-06-02 21:13:16,276 - INFO - ------------------------------------------------------------
2025-06-02 21:13:16,276 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 21:13:16,276 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 21:13:16,276 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 21:13:16,333 - ERROR - ERROR during visualization for Epoch 98: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 21:13:16,343 - INFO - 
-------------------- Starting Epoch 99/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 21:14:15,252 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 21:15:03,121 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 21:15:51,109 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 21:16:39,039 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 21:17:27,034 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 21:18:14,984 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 21:19:02,976 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 21:19:50,914 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 21:20:38,871 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 21:21:26,794 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 21:22:14,797 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 21:23:02,783 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 21:23:50,786 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 21:24:38,698 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 21:25:26,661 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 21:26:14,626 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 21:27:02,624 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 21:27:50,602 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 21:28:38,600 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 21:29:26,565 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 21:30:14,590 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 21:31:02,614 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 21:31:27,440 - INFO - ------------------------------------------------------------
2025-06-02 21:31:27,440 - INFO - Epoch 99/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.10s
2025-06-02 21:31:27,440 - INFO -   Avg Loss: 5.63573
2025-06-02 21:31:27,441 - INFO -   Avg MS-SSIM (opt): 0.97652
2025-06-02 21:31:27,441 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000404
2025-06-02 21:31:27,441 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.29476
2025-06-02 21:31:27,442 - INFO - ------------------------------------------------------------
2025-06-02 21:31:27,444 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 21:31:27,444 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 21:31:27,445 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 21:31:27,486 - ERROR - ERROR during visualization for Epoch 99: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 21:31:27,494 - INFO - 
-------------------- Starting Epoch 100/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 21:32:26,287 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 21:33:14,138 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 21:34:02,130 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 21:34:50,027 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 21:35:38,003 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 21:36:26,048 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 21:37:14,027 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 21:38:02,019 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 21:38:50,080 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 21:39:38,110 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 21:40:26,118 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 21:41:14,031 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 21:42:01,979 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 21:42:49,960 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 21:43:37,976 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 21:44:25,961 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 21:45:13,947 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 21:46:01,960 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 21:46:49,995 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 21:47:37,987 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 21:48:25,997 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 21:49:14,068 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 21:49:38,837 - INFO - ------------------------------------------------------------
2025-06-02 21:49:38,837 - INFO - Epoch 100/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.34s
2025-06-02 21:49:38,837 - INFO -   Avg Loss: 5.52814
2025-06-02 21:49:38,838 - INFO -   Avg MS-SSIM (opt): 0.97613
2025-06-02 21:49:38,838 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000395
2025-06-02 21:49:38,838 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.29098
2025-06-02 21:49:38,839 - INFO - ------------------------------------------------------------
2025-06-02 21:49:38,840 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 21:49:38,841 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 21:49:38,841 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 21:49:38,879 - ERROR - ERROR during visualization for Epoch 100: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 21:49:38,889 - INFO - 
-------------------- Starting Epoch 101/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 21:50:37,548 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 21:51:25,509 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 21:52:13,478 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 21:53:01,491 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 21:53:49,472 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 21:54:37,509 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 21:55:25,554 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 21:56:13,540 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 21:57:01,563 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 21:57:49,572 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 21:58:37,598 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 21:59:25,596 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 22:00:13,582 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 22:01:01,566 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 22:01:49,582 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 22:02:37,594 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 22:03:25,594 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 22:04:13,673 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 22:05:01,699 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 22:05:49,742 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 22:06:37,763 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 22:07:25,772 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 22:07:50,562 - INFO - ------------------------------------------------------------
2025-06-02 22:07:50,562 - INFO - Epoch 101/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.67s
2025-06-02 22:07:50,563 - INFO -   Avg Loss: 5.34316
2025-06-02 22:07:50,563 - INFO -   Avg MS-SSIM (opt): 0.97680
2025-06-02 22:07:50,564 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000375
2025-06-02 22:07:50,564 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.29465
2025-06-02 22:07:50,564 - INFO - ------------------------------------------------------------
2025-06-02 22:07:50,567 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 22:07:50,568 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 22:07:50,568 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 22:07:50,731 - ERROR - ERROR during visualization for Epoch 101: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 22:07:50,739 - INFO - 
-------------------- Starting Epoch 102/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 22:08:49,587 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 22:09:37,460 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 22:10:25,492 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 22:11:13,405 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 22:12:01,364 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 22:12:49,283 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 22:13:37,158 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 22:14:25,067 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 22:15:12,920 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 22:16:00,853 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 22:16:48,755 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 22:17:36,628 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 22:18:24,704 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 22:19:12,645 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 22:20:00,602 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 22:20:48,517 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 22:21:36,445 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 22:22:24,351 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 22:23:12,273 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 22:24:00,197 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 22:24:48,099 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 22:25:36,065 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 22:26:00,806 - INFO - ------------------------------------------------------------
2025-06-02 22:26:00,806 - INFO - Epoch 102/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1090.07s
2025-06-02 22:26:00,806 - INFO -   Avg Loss: 5.84044
2025-06-02 22:26:00,806 - INFO -   Avg MS-SSIM (opt): 0.97528
2025-06-02 22:26:00,806 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000406
2025-06-02 22:26:00,806 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.33060
2025-06-02 22:26:00,806 - INFO - ------------------------------------------------------------
2025-06-02 22:26:00,806 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 22:26:00,811 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 22:26:00,811 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 22:26:00,864 - ERROR - ERROR during visualization for Epoch 102: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 22:26:00,874 - INFO - 
-------------------- Starting Epoch 103/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 22:26:59,572 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 22:27:47,421 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 22:28:35,392 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 22:29:23,274 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 22:30:11,271 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 22:30:59,152 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 22:31:47,079 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 22:32:34,978 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 22:33:22,909 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 22:34:10,797 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 22:34:58,696 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 22:35:46,640 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 22:36:34,615 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 22:37:22,606 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 22:38:10,604 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 22:38:58,705 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 22:39:46,667 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 22:40:34,726 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 22:41:22,746 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 22:42:10,728 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 22:42:58,862 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 22:43:46,882 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 22:44:11,697 - INFO - ------------------------------------------------------------
2025-06-02 22:44:11,697 - INFO - Epoch 103/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1090.82s
2025-06-02 22:44:11,698 - INFO -   Avg Loss: 6.11988
2025-06-02 22:44:11,698 - INFO -   Avg MS-SSIM (opt): 0.97481
2025-06-02 22:44:11,698 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000423
2025-06-02 22:44:11,699 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.35292
2025-06-02 22:44:11,699 - INFO - ------------------------------------------------------------
2025-06-02 22:44:11,701 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 22:44:11,701 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 22:44:11,701 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 22:44:11,745 - ERROR - ERROR during visualization for Epoch 103: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 22:44:11,753 - INFO - 
-------------------- Starting Epoch 104/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 22:45:10,498 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 22:45:58,351 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 22:46:46,354 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 22:47:34,313 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 22:48:22,338 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 22:49:10,333 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 22:49:58,381 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 22:50:46,492 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 22:51:34,588 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 22:52:22,616 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 22:53:10,646 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 22:53:58,720 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 22:54:46,784 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 22:55:34,862 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 22:56:22,856 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 22:57:10,882 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 22:57:58,943 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 22:58:46,944 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 22:59:34,962 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 23:00:22,989 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 23:01:10,983 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 23:01:59,020 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 23:02:23,818 - INFO - ------------------------------------------------------------
2025-06-02 23:02:23,819 - INFO - Epoch 104/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1092.07s
2025-06-02 23:02:23,819 - INFO -   Avg Loss: 5.70731
2025-06-02 23:02:23,820 - INFO -   Avg MS-SSIM (opt): 0.97529
2025-06-02 23:02:23,820 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000398
2025-06-02 23:02:23,820 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.32031
2025-06-02 23:02:23,820 - INFO - ------------------------------------------------------------
2025-06-02 23:02:23,822 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 23:02:23,823 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 23:02:23,823 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 23:02:23,867 - ERROR - ERROR during visualization for Epoch 104: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 23:02:23,876 - INFO - 
-------------------- Starting Epoch 105/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 23:03:22,660 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 23:04:10,560 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 23:04:58,483 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 23:05:46,419 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 23:06:34,374 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 23:07:22,399 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 23:08:10,367 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 23:08:58,382 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 23:09:46,389 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 23:10:34,409 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 23:11:22,401 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 23:12:10,342 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 23:12:58,304 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 23:13:46,295 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 23:14:34,247 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 23:15:22,218 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 23:16:10,213 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 23:16:58,200 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 23:17:46,149 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 23:18:34,194 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 23:19:22,183 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 23:20:10,197 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 23:20:34,975 - INFO - ------------------------------------------------------------
2025-06-02 23:20:34,976 - INFO - Epoch 105/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.10s
2025-06-02 23:20:34,976 - INFO -   Avg Loss: 5.91150
2025-06-02 23:20:34,976 - INFO -   Avg MS-SSIM (opt): 0.97530
2025-06-02 23:20:34,976 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000410
2025-06-02 23:20:34,977 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.33668
2025-06-02 23:20:34,977 - INFO - ------------------------------------------------------------
2025-06-02 23:20:34,979 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 23:20:34,980 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 23:20:34,980 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 23:20:35,024 - ERROR - ERROR during visualization for Epoch 105: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 23:20:35,032 - INFO - 
-------------------- Starting Epoch 106/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 23:21:33,809 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 23:22:21,670 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 23:23:09,633 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 23:23:57,594 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 23:24:45,589 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 23:25:33,583 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 23:26:21,571 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 23:27:09,565 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 23:27:57,597 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 23:28:45,575 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 23:29:33,499 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 23:30:21,495 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 23:31:09,393 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 23:31:57,377 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 23:32:45,339 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 23:33:33,321 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 23:34:21,319 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 23:35:09,301 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 23:35:57,346 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 23:36:45,415 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 23:37:33,375 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 23:38:21,501 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 23:38:46,375 - INFO - ------------------------------------------------------------
2025-06-02 23:38:46,375 - INFO - Epoch 106/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.34s
2025-06-02 23:38:46,375 - INFO -   Avg Loss: 5.75218
2025-06-02 23:38:46,375 - INFO -   Avg MS-SSIM (opt): 0.97499
2025-06-02 23:38:46,375 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000401
2025-06-02 23:38:46,375 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.32255
2025-06-02 23:38:46,375 - INFO - ------------------------------------------------------------
2025-06-02 23:38:46,375 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 23:38:46,375 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 23:38:46,375 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 23:38:46,431 - ERROR - ERROR during visualization for Epoch 106: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 23:38:46,439 - INFO - 
-------------------- Starting Epoch 107/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 23:39:45,207 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 23:40:33,073 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 23:41:20,980 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-02 23:42:08,926 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-02 23:42:56,939 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-02 23:43:45,002 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-02 23:44:33,018 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-02 23:45:21,001 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-02 23:46:09,067 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-02 23:46:57,058 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-02 23:47:45,063 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-02 23:48:33,092 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-02 23:49:21,173 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-02 23:50:09,115 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-02 23:50:57,137 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-02 23:51:45,155 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-02 23:52:33,261 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-02 23:53:21,345 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-02 23:54:09,345 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-02 23:54:57,358 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-02 23:55:45,304 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-02 23:56:33,322 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-02 23:56:58,086 - INFO - ------------------------------------------------------------
2025-06-02 23:56:58,087 - INFO - Epoch 107/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.65s
2025-06-02 23:56:58,087 - INFO -   Avg Loss: 5.64207
2025-06-02 23:56:58,087 - INFO -   Avg MS-SSIM (opt): 0.97648
2025-06-02 23:56:58,088 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000390
2025-06-02 23:56:58,088 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.32519
2025-06-02 23:56:58,088 - INFO - ------------------------------------------------------------
2025-06-02 23:56:58,090 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-02 23:56:58,091 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-02 23:56:58,091 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-02 23:56:58,135 - ERROR - ERROR during visualization for Epoch 107: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-02 23:56:58,143 - INFO - 
-------------------- Starting Epoch 108/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-02 23:57:56,909 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-02 23:58:44,824 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-02 23:59:32,761 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 00:00:20,787 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 00:01:08,829 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 00:01:56,836 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 00:02:44,779 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 00:03:32,777 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 00:04:20,803 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 00:05:08,840 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 00:05:56,763 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 00:06:44,794 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 00:07:32,839 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 00:08:20,959 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 00:09:09,014 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 00:09:57,045 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 00:10:45,126 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 00:11:33,173 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 00:12:21,186 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 00:13:09,131 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 00:13:57,180 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 00:14:45,189 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 00:15:10,026 - INFO - ------------------------------------------------------------
2025-06-03 00:15:10,026 - INFO - Epoch 108/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1091.88s
2025-06-03 00:15:10,026 - INFO -   Avg Loss: 5.68387
2025-06-03 00:15:10,027 - INFO -   Avg MS-SSIM (opt): 0.97539
2025-06-03 00:15:10,027 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000393
2025-06-03 00:15:10,027 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.32702
2025-06-03 00:15:10,027 - INFO - ------------------------------------------------------------
2025-06-03 00:15:10,029 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 00:15:10,030 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 00:15:10,030 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 00:15:10,079 - ERROR - ERROR during visualization for Epoch 108: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 00:15:10,088 - INFO - 
-------------------- Starting Epoch 109/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 00:16:08,891 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 00:16:56,870 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 00:17:44,912 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 00:18:32,960 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 00:19:20,967 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 00:20:08,988 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 00:20:57,001 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 00:21:45,058 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 00:22:33,135 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 00:23:21,135 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 00:24:09,182 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 00:24:57,189 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 00:25:45,205 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 00:26:33,234 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 00:27:21,223 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 00:28:09,228 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 00:28:57,279 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 00:29:45,314 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 00:30:33,284 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 00:31:21,280 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 00:32:09,317 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 00:32:57,411 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 00:33:22,224 - INFO - ------------------------------------------------------------
2025-06-03 00:33:22,224 - INFO - Epoch 109/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1092.14s
2025-06-03 00:33:22,224 - INFO -   Avg Loss: 6.58382
2025-06-03 00:33:22,225 - INFO -   Avg MS-SSIM (opt): 0.97571
2025-06-03 00:33:22,225 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000412
2025-06-03 00:33:22,225 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.46874
2025-06-03 00:33:22,226 - INFO - ------------------------------------------------------------
2025-06-03 00:33:22,228 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 00:33:22,228 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 00:33:22,228 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 00:33:22,275 - ERROR - ERROR during visualization for Epoch 109: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 00:33:22,283 - INFO - 
-------------------- Starting Epoch 110/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 00:34:20,980 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 00:35:08,889 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 00:35:56,956 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 00:36:44,982 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 00:37:33,051 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 00:38:21,155 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 00:39:09,273 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 00:39:57,359 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 00:40:45,394 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 00:41:33,453 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 00:42:21,552 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 00:43:09,587 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 00:43:57,708 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 00:44:45,823 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 00:45:33,869 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 00:46:21,942 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 00:47:10,013 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 00:47:58,132 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 00:48:46,333 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 00:49:34,430 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 00:50:22,405 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 00:51:10,483 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 00:51:35,287 - INFO - ------------------------------------------------------------
2025-06-03 00:51:35,288 - INFO - Epoch 110/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1093.00s
2025-06-03 00:51:35,288 - INFO -   Avg Loss: 6.65298
2025-06-03 00:51:35,288 - INFO -   Avg MS-SSIM (opt): 0.97392
2025-06-03 00:51:35,289 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000421
2025-06-03 00:51:35,289 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.46189
2025-06-03 00:51:35,289 - INFO - ------------------------------------------------------------
2025-06-03 00:51:35,291 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 00:51:35,292 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 00:51:35,292 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 00:51:35,340 - ERROR - ERROR during visualization for Epoch 110: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 00:51:35,349 - INFO - 
-------------------- Starting Epoch 111/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 00:52:34,119 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 00:53:22,077 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 00:54:10,132 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 00:54:58,122 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 00:55:46,164 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 00:56:34,221 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 00:57:22,237 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 00:58:10,243 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 00:58:58,307 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 00:59:46,389 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 01:00:34,415 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 01:01:22,427 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 01:02:10,470 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 01:02:58,496 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 01:03:46,511 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 01:04:34,529 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 01:05:22,538 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 01:06:10,630 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 01:06:58,613 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 01:07:46,722 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 01:08:34,763 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 01:09:22,777 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 01:09:47,591 - INFO - ------------------------------------------------------------
2025-06-03 01:09:47,591 - INFO - Epoch 111/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1092.24s
2025-06-03 01:09:47,591 - INFO -   Avg Loss: 6.68144
2025-06-03 01:09:47,591 - INFO -   Avg MS-SSIM (opt): 0.97485
2025-06-03 01:09:47,591 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000423
2025-06-03 01:09:47,591 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.46524
2025-06-03 01:09:47,591 - INFO - ------------------------------------------------------------
2025-06-03 01:09:47,591 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 01:09:47,591 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 01:09:47,591 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 01:09:47,652 - ERROR - ERROR during visualization for Epoch 111: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 01:09:47,662 - INFO - 
-------------------- Starting Epoch 112/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 01:10:46,390 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 01:11:34,406 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 01:12:22,342 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 01:13:10,440 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 01:13:58,518 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 01:14:46,548 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 01:15:34,558 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 01:16:22,619 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 01:17:10,679 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 01:17:58,769 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 01:18:46,790 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 01:19:34,828 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 01:20:23,006 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 01:21:11,080 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 01:21:59,185 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 01:22:47,235 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 01:23:35,362 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 01:24:23,476 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 01:25:11,558 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 01:25:59,649 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 01:26:47,635 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 01:27:35,764 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 01:28:00,557 - INFO - ------------------------------------------------------------
2025-06-03 01:28:00,557 - INFO - Epoch 112/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1092.89s
2025-06-03 01:28:00,557 - INFO -   Avg Loss: 6.19514
2025-06-03 01:28:00,557 - INFO -   Avg MS-SSIM (opt): 0.97430
2025-06-03 01:28:00,557 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000414
2025-06-03 01:28:00,557 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.38465
2025-06-03 01:28:00,557 - INFO - ------------------------------------------------------------
2025-06-03 01:28:00,574 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 01:28:00,575 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 01:28:00,575 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 01:28:00,782 - ERROR - ERROR during visualization for Epoch 112: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 01:28:00,790 - INFO - 
-------------------- Starting Epoch 113/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 01:28:59,636 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 01:29:47,668 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 01:30:35,639 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 01:31:23,703 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 01:32:11,730 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 01:32:59,719 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 01:33:47,837 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 01:34:35,915 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 01:35:24,014 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 01:36:12,080 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 01:37:00,206 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 01:37:48,260 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 01:38:36,450 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 01:39:24,501 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 01:40:12,564 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 01:41:00,621 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 01:41:48,658 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 01:42:36,680 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 01:43:24,700 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 01:44:12,723 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 01:45:00,713 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 01:45:48,788 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 01:46:13,601 - INFO - ------------------------------------------------------------
2025-06-03 01:46:13,601 - INFO - Epoch 113/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1092.81s
2025-06-03 01:46:13,602 - INFO -   Avg Loss: 6.37252
2025-06-03 01:46:13,602 - INFO -   Avg MS-SSIM (opt): 0.97578
2025-06-03 01:46:13,602 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000410
2025-06-03 01:46:13,603 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.42963
2025-06-03 01:46:13,603 - INFO - ------------------------------------------------------------
2025-06-03 01:46:13,605 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 01:46:13,606 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 01:46:13,606 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 01:46:13,652 - ERROR - ERROR during visualization for Epoch 113: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 01:46:13,662 - INFO - 
-------------------- Starting Epoch 114/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 01:47:12,534 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 01:48:00,453 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 01:48:48,493 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 01:49:36,523 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 01:50:24,557 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 01:51:12,590 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 01:52:00,626 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 01:52:48,645 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 01:53:36,720 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 01:54:24,773 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 01:55:12,763 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 01:56:00,789 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 01:56:48,797 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 01:57:36,809 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 01:58:24,841 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 01:59:12,910 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 02:00:00,943 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 02:00:49,054 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 02:01:37,099 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 02:02:25,197 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 02:03:13,231 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 02:04:01,290 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 02:04:26,061 - INFO - ------------------------------------------------------------
2025-06-03 02:04:26,061 - INFO - Epoch 114/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1092.40s
2025-06-03 02:04:26,061 - INFO -   Avg Loss: 7.61465
2025-06-03 02:04:26,061 - INFO -   Avg MS-SSIM (opt): 0.97415
2025-06-03 02:04:26,061 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000432
2025-06-03 02:04:26,077 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.63300
2025-06-03 02:04:26,077 - INFO - ------------------------------------------------------------
2025-06-03 02:04:26,079 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 02:04:26,080 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 02:04:26,080 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 02:04:26,126 - ERROR - ERROR during visualization for Epoch 114: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 02:04:26,134 - INFO - 
-------------------- Starting Epoch 115/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 02:05:24,961 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 02:06:12,920 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 02:07:00,973 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 02:07:49,020 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 02:08:37,117 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 02:09:25,197 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 02:10:13,336 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 02:11:01,400 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 02:11:49,436 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 02:12:37,523 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 02:13:25,563 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 02:14:13,654 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 02:15:01,704 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 02:15:49,778 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 02:16:37,956 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 02:17:26,022 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 02:18:14,168 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 02:19:02,247 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 02:19:50,382 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 02:20:38,503 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 02:21:26,523 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 02:22:14,645 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 02:22:39,508 - INFO - ------------------------------------------------------------
2025-06-03 02:22:39,509 - INFO - Epoch 115/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1093.37s
2025-06-03 02:22:39,509 - INFO -   Avg Loss: 6.19383
2025-06-03 02:22:39,509 - INFO -   Avg MS-SSIM (opt): 0.97559
2025-06-03 02:22:39,509 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000417
2025-06-03 02:22:39,509 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.38022
2025-06-03 02:22:39,510 - INFO - ------------------------------------------------------------
2025-06-03 02:22:39,511 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 02:22:39,512 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 02:22:39,512 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 02:22:39,556 - ERROR - ERROR during visualization for Epoch 115: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 02:22:39,563 - INFO - 
-------------------- Starting Epoch 116/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 02:23:38,467 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 02:24:26,437 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 02:25:14,424 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 02:26:02,428 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 02:26:50,432 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 02:27:38,445 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 02:28:26,541 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 02:29:14,684 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 02:30:02,732 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 02:30:50,744 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 02:31:38,805 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 02:32:26,876 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 02:33:14,913 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 02:34:03,005 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 02:34:51,142 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 02:35:39,181 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 02:36:27,245 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 02:37:15,277 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 02:38:03,355 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 02:38:51,438 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 02:39:39,464 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 02:40:27,960 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 02:40:53,691 - INFO - ------------------------------------------------------------
2025-06-03 02:40:53,691 - INFO - Epoch 116/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1094.13s
2025-06-03 02:40:53,691 - INFO -   Avg Loss: 5.84316
2025-06-03 02:40:53,692 - INFO -   Avg MS-SSIM (opt): 0.97675
2025-06-03 02:40:53,692 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000396
2025-06-03 02:40:53,692 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.35319
2025-06-03 02:40:53,692 - INFO - ------------------------------------------------------------
2025-06-03 02:40:53,693 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 02:40:53,693 - ERROR - ERROR saving checkpoint to ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar: File ./codec_checkpoints_2phase_visual\./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar cannot be opened.
2025-06-03 02:40:53,698 - ERROR - Make sure the directory exists and is writable. Check disk space if on Kaggle/limited environment.
2025-06-03 02:40:53,758 - ERROR - ERROR during visualization for Epoch 116: 'Figure' object has no attribute 'GCF'
Traceback (most recent call last):
  File "C:\Users\Anis\Desktop\XX\train_msssim.py", line 716, in visualize_epoch_end
    fig. GCF().set_facecolor('white') # Set background to white
    ^^^^^^^^
AttributeError: 'Figure' object has no attribute 'GCF'

2025-06-03 02:40:53,764 - INFO - 
-------------------- Starting Epoch 117/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 06:26:40,513 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 06:26:40,513 - INFO - Configuration:
2025-06-03 06:26:40,513 - INFO -   frame_base_dir: ./sequence
2025-06-03 06:26:40,514 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 06:26:40,514 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 06:26:40,514 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 06:26:40,514 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 06:26:40,514 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 06:26:40,514 - INFO -   motion_latent_channels: 128
2025-06-03 06:26:40,514 - INFO -   residual_latent_channels: 192
2025-06-03 06:26:40,514 - INFO -   mcn_base_channels: 32
2025-06-03 06:26:40,515 - INFO -   encoder_base_channels: 64
2025-06-03 06:26:40,515 - INFO -   encoder_res_blocks: 2
2025-06-03 06:26:40,515 - INFO -   encoder_downsample_layers: 3
2025-06-03 06:26:40,515 - INFO -   decoder_res_blocks: 2
2025-06-03 06:26:40,515 - INFO -   decoder_upsample_layers: 3
2025-06-03 06:26:40,515 - INFO -   epochs: 1000
2025-06-03 06:26:40,515 - INFO -   batch_size: 4
2025-06-03 06:26:40,515 - INFO -   learning_rate: 0.0001
2025-06-03 06:26:40,515 - INFO -   weight_decay: 1e-05
2025-06-03 06:26:40,515 - INFO -   clip_max_norm: 1.0
2025-06-03 06:26:40,516 - INFO -   seed: 42
2025-06-03 06:26:40,516 - INFO -   num_workers: 2
2025-06-03 06:26:40,516 - INFO -   use_amp: True
2025-06-03 06:26:40,516 - INFO -   bitstream_calc_freq: 200
2025-06-03 06:26:40,516 - INFO -   phase1_epochs: 30
2025-06-03 06:26:40,516 - INFO -   phase3_start_epoch: 97
2025-06-03 06:26:40,516 - INFO -   lambda_mse_flow: 10.0
2025-06-03 06:26:40,516 - INFO -   lambda_mse_residual: 10000.0
2025-06-03 06:26:40,516 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 06:26:40,516 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 06:26:40,517 - INFO -   lambda_msssim_phase3: 5.0
2025-06-03 06:26:40,517 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 06:26:40,517 - INFO -   freeze_mcn_phase1: True
2025-06-03 06:26:40,517 - INFO -   device: cuda
2025-06-03 06:26:40,517 - INFO - ------------------------------------------------------------
2025-06-03 06:26:40,517 - INFO - Setting up dataset...
2025-06-03 06:26:40,518 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 06:26:40,959 - INFO - Found 21000 potential frame files.
2025-06-03 06:26:40,959 - INFO - Grouping frames by directory...
2025-06-03 06:26:41,050 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 06:26:41,861 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 06:26:41,872 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 06:26:41,872 - INFO - Initializing Video Codec model...
2025-06-03 06:26:42,124 - INFO - Using a single GPU or CPU.
2025-06-03 06:26:42,125 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 06:26:42,126 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:26:42,126 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:26:42,126 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 06:26:42,311 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 06:26:42,551 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 06:26:42,604 - INFO - Loading optimizer state...
2025-06-03 06:26:42,714 - INFO - Optimizer state loaded successfully.
2025-06-03 06:26:42,715 - INFO - Loading GradScaler state...
2025-06-03 06:26:42,715 - INFO - GradScaler state loaded successfully.
2025-06-03 06:26:42,715 - INFO - Checkpoint loaded. Resuming from Epoch 96. Optimizer mode was 'full'.
2025-06-03 06:26:42,716 - INFO - Resumed successfully. Training from Epoch 97. Optimizer mode was 'full'.
2025-06-03 06:26:42,717 - INFO - --- Starting Training Loop from Epoch 97 up to 1000 ---
2025-06-03 06:26:42,719 - INFO - 
-------------------- Starting Epoch 97/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 06:26:42,720 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 06:26:42,721 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 06:26:42,721 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 06:27:40,576 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 06:28:28,190 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 06:28:46,361 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 06:37:09,751 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 06:37:09,751 - INFO - Configuration:
2025-06-03 06:37:09,751 - INFO -   frame_base_dir: ./sequence
2025-06-03 06:37:09,751 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 06:37:09,751 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 06:37:09,751 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 06:37:09,751 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 06:37:09,751 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 06:37:09,751 - INFO -   motion_latent_channels: 128
2025-06-03 06:37:09,751 - INFO -   residual_latent_channels: 192
2025-06-03 06:37:09,751 - INFO -   mcn_base_channels: 32
2025-06-03 06:37:09,751 - INFO -   encoder_base_channels: 64
2025-06-03 06:37:09,756 - INFO -   encoder_res_blocks: 2
2025-06-03 06:37:09,756 - INFO -   encoder_downsample_layers: 3
2025-06-03 06:37:09,756 - INFO -   decoder_res_blocks: 2
2025-06-03 06:37:09,756 - INFO -   decoder_upsample_layers: 3
2025-06-03 06:37:09,756 - INFO -   epochs: 1000
2025-06-03 06:37:09,756 - INFO -   batch_size: 4
2025-06-03 06:37:09,756 - INFO -   learning_rate: 0.0001
2025-06-03 06:37:09,757 - INFO -   weight_decay: 1e-05
2025-06-03 06:37:09,757 - INFO -   clip_max_norm: 1.0
2025-06-03 06:37:09,757 - INFO -   seed: 42
2025-06-03 06:37:09,757 - INFO -   num_workers: 2
2025-06-03 06:37:09,757 - INFO -   use_amp: True
2025-06-03 06:37:09,757 - INFO -   bitstream_calc_freq: 200
2025-06-03 06:37:09,757 - INFO -   phase1_epochs: 30
2025-06-03 06:37:09,758 - INFO -   phase3_start_epoch: 97
2025-06-03 06:37:09,758 - INFO -   lambda_mse_flow: 10.0
2025-06-03 06:37:09,758 - INFO -   lambda_mse_residual: 10000.0
2025-06-03 06:37:09,760 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 06:37:09,761 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 06:37:09,761 - INFO -   lambda_msssim_phase3: 5.0
2025-06-03 06:37:09,761 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 06:37:09,762 - INFO -   freeze_mcn_phase1: True
2025-06-03 06:37:09,762 - INFO -   device: cuda
2025-06-03 06:37:09,762 - INFO - ------------------------------------------------------------
2025-06-03 06:37:09,762 - INFO - Setting up dataset...
2025-06-03 06:37:09,763 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 06:37:10,209 - INFO - Found 21000 potential frame files.
2025-06-03 06:37:10,209 - INFO - Grouping frames by directory...
2025-06-03 06:37:10,305 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 06:37:11,103 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 06:37:11,112 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 06:37:11,113 - INFO - Initializing Video Codec model...
2025-06-03 06:37:11,370 - INFO - Using a single GPU or CPU.
2025-06-03 06:37:11,371 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 06:37:11,372 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:37:11,372 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:37:11,372 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 06:37:11,562 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 06:37:11,771 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 06:37:11,825 - INFO - Loading optimizer state...
2025-06-03 06:37:11,935 - INFO - Optimizer state loaded successfully.
2025-06-03 06:37:11,936 - INFO - Loading GradScaler state...
2025-06-03 06:37:11,936 - INFO - GradScaler state loaded successfully.
2025-06-03 06:37:11,936 - INFO - Checkpoint loaded. Resuming from Epoch 96. Optimizer mode was 'full'.
2025-06-03 06:37:11,937 - INFO - Resumed successfully. Training from Epoch 97. Optimizer mode was 'full'.
2025-06-03 06:37:11,939 - INFO - --- Starting Training Loop from Epoch 97 up to 1000 ---
2025-06-03 06:37:11,940 - INFO - 
-------------------- Starting Epoch 97/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 06:37:11,942 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 06:37:11,942 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 06:37:11,942 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 06:38:10,186 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 06:38:57,543 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 06:39:45,198 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 06:40:32,981 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 06:41:20,730 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 06:42:08,609 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 06:42:56,444 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 06:43:44,334 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 06:44:32,319 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 06:45:20,260 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 06:46:08,279 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 06:46:56,346 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 06:47:44,422 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 06:48:32,471 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 06:49:20,547 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 06:50:08,663 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 06:50:56,769 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 06:51:44,881 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 06:52:33,029 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 06:53:21,212 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 06:54:09,296 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 06:54:57,389 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 06:55:22,345 - INFO - ------------------------------------------------------------
2025-06-03 06:55:22,345 - INFO - Epoch 97/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1090.40s
2025-06-03 06:55:22,345 - INFO -   Avg Loss: 5.40311
2025-06-03 06:55:22,346 - INFO -   Avg MS-SSIM (opt): 0.97768
2025-06-03 06:55:22,346 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000400
2025-06-03 06:55:22,347 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.25793
2025-06-03 06:55:22,347 - INFO - ------------------------------------------------------------
2025-06-03 06:55:22,350 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:55:22,707 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:55:24,309 - INFO - 
-------------------- Starting Epoch 98/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 06:56:21,865 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 06:57:02,212 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 06:57:02,212 - INFO - Configuration:
2025-06-03 06:57:02,213 - INFO -   frame_base_dir: ./sequence
2025-06-03 06:57:02,214 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 06:57:02,214 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 06:57:02,214 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 06:57:02,214 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 06:57:02,214 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 06:57:02,214 - INFO -   motion_latent_channels: 128
2025-06-03 06:57:02,215 - INFO -   residual_latent_channels: 192
2025-06-03 06:57:02,215 - INFO -   mcn_base_channels: 32
2025-06-03 06:57:02,215 - INFO -   encoder_base_channels: 64
2025-06-03 06:57:02,215 - INFO -   encoder_res_blocks: 2
2025-06-03 06:57:02,215 - INFO -   encoder_downsample_layers: 3
2025-06-03 06:57:02,215 - INFO -   decoder_res_blocks: 2
2025-06-03 06:57:02,215 - INFO -   decoder_upsample_layers: 3
2025-06-03 06:57:02,215 - INFO -   epochs: 1000
2025-06-03 06:57:02,216 - INFO -   batch_size: 4
2025-06-03 06:57:02,216 - INFO -   learning_rate: 0.0001
2025-06-03 06:57:02,216 - INFO -   weight_decay: 1e-05
2025-06-03 06:57:02,216 - INFO -   clip_max_norm: 1.0
2025-06-03 06:57:02,216 - INFO -   seed: 42
2025-06-03 06:57:02,216 - INFO -   num_workers: 2
2025-06-03 06:57:02,216 - INFO -   use_amp: True
2025-06-03 06:57:02,217 - INFO -   bitstream_calc_freq: 200
2025-06-03 06:57:02,217 - INFO -   phase1_epochs: 30
2025-06-03 06:57:02,217 - INFO -   phase3_start_epoch: 97
2025-06-03 06:57:02,217 - INFO -   lambda_mse_flow: 10.0
2025-06-03 06:57:02,217 - INFO -   lambda_mse_residual: 10000.0
2025-06-03 06:57:02,217 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 06:57:02,217 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 06:57:02,217 - INFO -   lambda_msssim_phase3: 100.0
2025-06-03 06:57:02,218 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 06:57:02,218 - INFO -   freeze_mcn_phase1: True
2025-06-03 06:57:02,218 - INFO -   device: cuda
2025-06-03 06:57:02,218 - INFO - ------------------------------------------------------------
2025-06-03 06:57:02,218 - INFO - Setting up dataset...
2025-06-03 06:57:02,219 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 06:57:02,633 - INFO - Found 21000 potential frame files.
2025-06-03 06:57:02,634 - INFO - Grouping frames by directory...
2025-06-03 06:57:02,718 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 06:57:03,524 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 06:57:03,536 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 06:57:03,537 - INFO - Initializing Video Codec model...
2025-06-03 06:57:03,790 - INFO - Using a single GPU or CPU.
2025-06-03 06:57:03,790 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 06:57:03,790 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:57:03,790 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 06:57:03,790 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 06:57:03,948 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 06:57:04,150 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 06:57:04,203 - INFO - Loading optimizer state...
2025-06-03 06:57:04,204 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 06:57:04,204 - INFO - Loading GradScaler state...
2025-06-03 06:57:04,204 - INFO - GradScaler state loaded successfully.
2025-06-03 06:57:04,204 - INFO - Checkpoint loaded. Resuming from Epoch 97. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 06:57:04,205 - INFO - Resumed successfully. Training from Epoch 98. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 06:57:04,207 - INFO - --- Starting Training Loop from Epoch 98 up to 1000 ---
2025-06-03 06:57:04,208 - INFO - 
-------------------- Starting Epoch 98/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 06:57:04,208 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 06:57:04,209 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 06:57:04,209 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 06:58:01,953 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 06:58:49,353 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 06:59:37,129 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 07:00:25,127 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 07:01:13,161 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 07:02:01,219 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 07:02:12,846 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 07:02:40,110 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 07:02:40,110 - INFO - Configuration:
2025-06-03 07:02:40,110 - INFO -   frame_base_dir: ./sequence
2025-06-03 07:02:40,110 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 07:02:40,110 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 07:02:40,110 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 07:02:40,110 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 07:02:40,110 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 07:02:40,110 - INFO -   motion_latent_channels: 128
2025-06-03 07:02:40,110 - INFO -   residual_latent_channels: 192
2025-06-03 07:02:40,110 - INFO -   mcn_base_channels: 32
2025-06-03 07:02:40,110 - INFO -   encoder_base_channels: 64
2025-06-03 07:02:40,110 - INFO -   encoder_res_blocks: 2
2025-06-03 07:02:40,110 - INFO -   encoder_downsample_layers: 3
2025-06-03 07:02:40,110 - INFO -   decoder_res_blocks: 2
2025-06-03 07:02:40,110 - INFO -   decoder_upsample_layers: 3
2025-06-03 07:02:40,110 - INFO -   epochs: 1000
2025-06-03 07:02:40,110 - INFO -   batch_size: 4
2025-06-03 07:02:40,110 - INFO -   learning_rate: 0.0001
2025-06-03 07:02:40,121 - INFO -   weight_decay: 1e-05
2025-06-03 07:02:40,121 - INFO -   clip_max_norm: 1.0
2025-06-03 07:02:40,121 - INFO -   seed: 42
2025-06-03 07:02:40,121 - INFO -   num_workers: 2
2025-06-03 07:02:40,121 - INFO -   use_amp: True
2025-06-03 07:02:40,122 - INFO -   bitstream_calc_freq: 200
2025-06-03 07:02:40,122 - INFO -   phase1_epochs: 30
2025-06-03 07:02:40,122 - INFO -   phase3_start_epoch: 97
2025-06-03 07:02:40,122 - INFO -   lambda_mse_flow: 10.0
2025-06-03 07:02:40,122 - INFO -   lambda_mse_residual: 10000.0
2025-06-03 07:02:40,122 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 07:02:40,123 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 07:02:40,123 - INFO -   lambda_msssim_phase3: 5.0
2025-06-03 07:02:40,123 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 07:02:40,123 - INFO -   freeze_mcn_phase1: True
2025-06-03 07:02:40,123 - INFO -   device: cuda
2025-06-03 07:02:40,123 - INFO - ------------------------------------------------------------
2025-06-03 07:02:40,123 - INFO - Setting up dataset...
2025-06-03 07:02:40,124 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 07:02:40,518 - INFO - Found 21000 potential frame files.
2025-06-03 07:02:40,518 - INFO - Grouping frames by directory...
2025-06-03 07:02:40,609 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 07:02:41,416 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 07:02:41,416 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 07:02:41,416 - INFO - Initializing Video Codec model...
2025-06-03 07:02:41,693 - INFO - Using a single GPU or CPU.
2025-06-03 07:02:41,694 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 07:02:41,694 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:02:41,695 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:02:41,695 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 07:02:41,832 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 07:02:42,032 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 07:02:42,081 - INFO - Loading optimizer state...
2025-06-03 07:02:42,081 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 07:02:42,081 - INFO - Loading GradScaler state...
2025-06-03 07:02:42,081 - INFO - GradScaler state loaded successfully.
2025-06-03 07:02:42,081 - INFO - Checkpoint loaded. Resuming from Epoch 97. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 07:02:42,081 - INFO - Resumed successfully. Training from Epoch 98. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 07:02:42,081 - INFO - --- Starting Training Loop from Epoch 98 up to 1000 ---
2025-06-03 07:02:42,081 - INFO - 
-------------------- Starting Epoch 98/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 07:02:42,081 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 07:02:42,081 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 07:02:42,096 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 07:03:28,619 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 07:04:20,291 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 07:04:20,291 - INFO - Configuration:
2025-06-03 07:04:20,291 - INFO -   frame_base_dir: ./sequence
2025-06-03 07:04:20,291 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 07:04:20,291 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 07:04:20,291 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 07:04:20,291 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 07:04:20,291 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 07:04:20,291 - INFO -   motion_latent_channels: 128
2025-06-03 07:04:20,296 - INFO -   residual_latent_channels: 192
2025-06-03 07:04:20,296 - INFO -   mcn_base_channels: 32
2025-06-03 07:04:20,296 - INFO -   encoder_base_channels: 64
2025-06-03 07:04:20,296 - INFO -   encoder_res_blocks: 2
2025-06-03 07:04:20,296 - INFO -   encoder_downsample_layers: 3
2025-06-03 07:04:20,296 - INFO -   decoder_res_blocks: 2
2025-06-03 07:04:20,296 - INFO -   decoder_upsample_layers: 3
2025-06-03 07:04:20,297 - INFO -   epochs: 1000
2025-06-03 07:04:20,297 - INFO -   batch_size: 4
2025-06-03 07:04:20,298 - INFO -   learning_rate: 0.0001
2025-06-03 07:04:20,298 - INFO -   weight_decay: 1e-05
2025-06-03 07:04:20,298 - INFO -   clip_max_norm: 1.0
2025-06-03 07:04:20,298 - INFO -   seed: 42
2025-06-03 07:04:20,298 - INFO -   num_workers: 2
2025-06-03 07:04:20,299 - INFO -   use_amp: True
2025-06-03 07:04:20,299 - INFO -   bitstream_calc_freq: 200
2025-06-03 07:04:20,299 - INFO -   phase1_epochs: 30
2025-06-03 07:04:20,299 - INFO -   phase3_start_epoch: 97
2025-06-03 07:04:20,299 - INFO -   lambda_mse_flow: 10.0
2025-06-03 07:04:20,299 - INFO -   lambda_mse_residual: 5000.0
2025-06-03 07:04:20,299 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 07:04:20,300 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 07:04:20,300 - INFO -   lambda_msssim_phase3: 10.0
2025-06-03 07:04:20,300 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 07:04:20,300 - INFO -   freeze_mcn_phase1: True
2025-06-03 07:04:20,300 - INFO -   device: cuda
2025-06-03 07:04:20,301 - INFO - ------------------------------------------------------------
2025-06-03 07:04:20,301 - INFO - Setting up dataset...
2025-06-03 07:04:20,302 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 07:04:20,716 - INFO - Found 21000 potential frame files.
2025-06-03 07:04:20,717 - INFO - Grouping frames by directory...
2025-06-03 07:04:20,806 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 07:04:21,617 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 07:04:21,626 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 07:04:21,627 - INFO - Initializing Video Codec model...
2025-06-03 07:04:21,879 - INFO - Using a single GPU or CPU.
2025-06-03 07:04:21,879 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 07:04:21,879 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:04:21,879 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:04:21,879 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 07:04:22,029 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 07:04:22,229 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 07:04:22,279 - INFO - Loading optimizer state...
2025-06-03 07:04:22,279 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 07:04:22,279 - INFO - Loading GradScaler state...
2025-06-03 07:04:22,279 - INFO - GradScaler state loaded successfully.
2025-06-03 07:04:22,279 - INFO - Checkpoint loaded. Resuming from Epoch 97. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 07:04:22,279 - INFO - Resumed successfully. Training from Epoch 98. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 07:04:22,279 - INFO - --- Starting Training Loop from Epoch 98 up to 1000 ---
2025-06-03 07:04:22,279 - INFO - 
-------------------- Starting Epoch 98/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 07:04:22,279 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 07:04:22,293 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 07:04:22,293 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 07:05:19,796 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 07:06:07,085 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 07:06:54,700 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 07:07:42,492 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 07:08:30,525 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 07:09:18,553 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 07:10:06,408 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 07:10:54,244 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 07:11:42,018 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 07:12:29,810 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 07:13:17,555 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 07:14:05,381 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2400: too many values to unpack (expected 2)
2025-06-03 07:14:53,201 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2600: too many values to unpack (expected 2)
2025-06-03 07:15:41,072 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2800: too many values to unpack (expected 2)
2025-06-03 07:16:28,805 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3000: too many values to unpack (expected 2)
2025-06-03 07:17:16,679 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3200: too many values to unpack (expected 2)
2025-06-03 07:18:04,702 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3400: too many values to unpack (expected 2)
2025-06-03 07:18:52,841 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3600: too many values to unpack (expected 2)
2025-06-03 07:19:40,821 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 3800: too many values to unpack (expected 2)
2025-06-03 07:20:28,855 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4000: too many values to unpack (expected 2)
2025-06-03 07:21:16,901 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4200: too many values to unpack (expected 2)
2025-06-03 07:22:05,053 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 4400: too many values to unpack (expected 2)
2025-06-03 07:22:29,989 - INFO - ------------------------------------------------------------
2025-06-03 07:22:29,989 - INFO - Epoch 98/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1087.70s
2025-06-03 07:22:29,992 - INFO -   Avg Loss: 3.68469
2025-06-03 07:22:29,992 - INFO -   Avg MS-SSIM (opt): 0.97714
2025-06-03 07:22:29,992 - INFO -   Avg MSE_Flow (mon): 0.797702 | MSE_Res (opt): 0.000446
2025-06-03 07:22:29,992 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.24484
2025-06-03 07:22:29,992 - INFO - ------------------------------------------------------------
2025-06-03 07:22:29,995 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:22:30,356 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:22:31,975 - INFO - 
-------------------- Starting Epoch 99/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 07:23:31,482 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 07:23:40,815 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 07:24:01,095 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 07:24:01,095 - INFO - Configuration:
2025-06-03 07:24:01,096 - INFO -   frame_base_dir: ./sequence
2025-06-03 07:24:01,096 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 07:24:01,096 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 07:24:01,096 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 07:24:01,096 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 07:24:01,096 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 07:24:01,096 - INFO -   motion_latent_channels: 128
2025-06-03 07:24:01,097 - INFO -   residual_latent_channels: 192
2025-06-03 07:24:01,097 - INFO -   mcn_base_channels: 32
2025-06-03 07:24:01,097 - INFO -   encoder_base_channels: 64
2025-06-03 07:24:01,097 - INFO -   encoder_res_blocks: 2
2025-06-03 07:24:01,097 - INFO -   encoder_downsample_layers: 3
2025-06-03 07:24:01,097 - INFO -   decoder_res_blocks: 2
2025-06-03 07:24:01,098 - INFO -   decoder_upsample_layers: 3
2025-06-03 07:24:01,098 - INFO -   epochs: 1000
2025-06-03 07:24:01,098 - INFO -   batch_size: 4
2025-06-03 07:24:01,098 - INFO -   learning_rate: 0.0001
2025-06-03 07:24:01,098 - INFO -   weight_decay: 1e-05
2025-06-03 07:24:01,099 - INFO -   clip_max_norm: 1.0
2025-06-03 07:24:01,099 - INFO -   seed: 42
2025-06-03 07:24:01,099 - INFO -   num_workers: 2
2025-06-03 07:24:01,099 - INFO -   use_amp: True
2025-06-03 07:24:01,099 - INFO -   bitstream_calc_freq: 200
2025-06-03 07:24:01,099 - INFO -   phase1_epochs: 30
2025-06-03 07:24:01,100 - INFO -   phase3_start_epoch: 97
2025-06-03 07:24:01,100 - INFO -   lambda_mse_flow: 10.0
2025-06-03 07:24:01,100 - INFO -   lambda_mse_residual: 15000.0
2025-06-03 07:24:01,100 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 07:24:01,100 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 07:24:01,100 - INFO -   lambda_msssim_phase3: 10.0
2025-06-03 07:24:01,100 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 07:24:01,101 - INFO -   freeze_mcn_phase1: True
2025-06-03 07:24:01,101 - INFO -   device: cuda
2025-06-03 07:24:01,101 - INFO - ------------------------------------------------------------
2025-06-03 07:24:01,101 - INFO - Setting up dataset...
2025-06-03 07:24:01,102 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 07:24:01,502 - INFO - Found 21000 potential frame files.
2025-06-03 07:24:01,502 - INFO - Grouping frames by directory...
2025-06-03 07:24:01,594 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 07:24:02,409 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 07:24:02,421 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 07:24:02,422 - INFO - Initializing Video Codec model...
2025-06-03 07:24:02,675 - INFO - Using a single GPU or CPU.
2025-06-03 07:24:02,675 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 07:24:02,675 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:24:02,675 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 07:24:02,683 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 07:24:02,839 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 07:24:03,040 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 07:24:03,095 - INFO - Loading optimizer state...
2025-06-03 07:24:03,096 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 07:24:03,096 - INFO - Loading GradScaler state...
2025-06-03 07:24:03,096 - INFO - GradScaler state loaded successfully.
2025-06-03 07:24:03,097 - INFO - Checkpoint loaded. Resuming from Epoch 98. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 07:24:03,097 - INFO - Resumed successfully. Training from Epoch 99. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 07:24:03,099 - INFO - --- Starting Training Loop from Epoch 99 up to 1000 ---
2025-06-03 07:24:03,099 - INFO - 
-------------------- Starting Epoch 99/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 07:24:03,099 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 07:24:03,101 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 07:24:03,101 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 07:25:00,898 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 07:25:48,547 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 07:26:36,502 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 07:26:47,532 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 22:24:40,632 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 22:24:40,632 - INFO - Configuration:
2025-06-03 22:24:40,633 - INFO -   frame_base_dir: ./sequence
2025-06-03 22:24:40,633 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 22:24:40,633 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 22:24:40,633 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 22:24:40,633 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 22:24:40,633 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 22:24:40,634 - INFO -   motion_latent_channels: 128
2025-06-03 22:24:40,634 - INFO -   residual_latent_channels: 192
2025-06-03 22:24:40,634 - INFO -   mcn_base_channels: 32
2025-06-03 22:24:40,634 - INFO -   encoder_base_channels: 64
2025-06-03 22:24:40,634 - INFO -   encoder_res_blocks: 2
2025-06-03 22:24:40,634 - INFO -   encoder_downsample_layers: 3
2025-06-03 22:24:40,634 - INFO -   decoder_res_blocks: 2
2025-06-03 22:24:40,634 - INFO -   decoder_upsample_layers: 3
2025-06-03 22:24:40,634 - INFO -   epochs: 1000
2025-06-03 22:24:40,634 - INFO -   batch_size: 4
2025-06-03 22:24:40,635 - INFO -   learning_rate: 0.0001
2025-06-03 22:24:40,635 - INFO -   weight_decay: 1e-05
2025-06-03 22:24:40,635 - INFO -   clip_max_norm: 1.0
2025-06-03 22:24:40,635 - INFO -   seed: 42
2025-06-03 22:24:40,635 - INFO -   num_workers: 2
2025-06-03 22:24:40,635 - INFO -   use_amp: True
2025-06-03 22:24:40,635 - INFO -   bitstream_calc_freq: 200
2025-06-03 22:24:40,635 - INFO -   phase1_epochs: 30
2025-06-03 22:24:40,636 - INFO -   phase3_start_epoch: 97
2025-06-03 22:24:40,636 - INFO -   lambda_mse_flow: 10.0
2025-06-03 22:24:40,636 - INFO -   lambda_mse_residual: 15000.0
2025-06-03 22:24:40,636 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 22:24:40,636 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 22:24:40,636 - INFO -   lambda_msssim_phase3: 50.0
2025-06-03 22:24:40,636 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 22:24:40,636 - INFO -   freeze_mcn_phase1: True
2025-06-03 22:24:40,637 - INFO -   device: cuda
2025-06-03 22:24:40,637 - INFO - ------------------------------------------------------------
2025-06-03 22:24:40,637 - INFO - Setting up dataset...
2025-06-03 22:24:40,638 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 22:24:41,116 - INFO - Found 21000 potential frame files.
2025-06-03 22:24:41,116 - INFO - Grouping frames by directory...
2025-06-03 22:24:41,216 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 22:24:42,015 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 22:24:42,034 - INFO - Dataset loaded: 18000 pairs. DataLoader: 4500 batches.
2025-06-03 22:24:42,035 - INFO - Initializing Video Codec model...
2025-06-03 22:24:42,301 - INFO - Using a single GPU or CPU.
2025-06-03 22:24:42,302 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 22:24:42,303 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:24:42,304 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:24:42,304 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 22:24:42,439 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 22:24:42,693 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 22:24:42,751 - INFO - Loading optimizer state...
2025-06-03 22:24:42,752 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 22:24:42,752 - INFO - Loading GradScaler state...
2025-06-03 22:24:42,752 - INFO - GradScaler state loaded successfully.
2025-06-03 22:24:42,752 - INFO - Checkpoint loaded. Resuming from Epoch 98. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 22:24:42,753 - INFO - Resumed successfully. Training from Epoch 99. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 22:24:42,755 - INFO - --- Starting Training Loop from Epoch 99 up to 1000 ---
2025-06-03 22:24:42,755 - INFO - 
-------------------- Starting Epoch 99/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 22:24:42,755 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 22:24:42,755 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 22:24:42,757 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 22:25:05,733 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 22:25:21,221 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 22:25:21,221 - INFO - Configuration:
2025-06-03 22:25:21,221 - INFO -   frame_base_dir: ./sequence
2025-06-03 22:25:21,236 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 22:25:21,237 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 22:25:21,237 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 22:25:21,237 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 22:25:21,237 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 22:25:21,237 - INFO -   motion_latent_channels: 128
2025-06-03 22:25:21,237 - INFO -   residual_latent_channels: 192
2025-06-03 22:25:21,237 - INFO -   mcn_base_channels: 32
2025-06-03 22:25:21,237 - INFO -   encoder_base_channels: 64
2025-06-03 22:25:21,239 - INFO -   encoder_res_blocks: 2
2025-06-03 22:25:21,239 - INFO -   encoder_downsample_layers: 3
2025-06-03 22:25:21,239 - INFO -   decoder_res_blocks: 2
2025-06-03 22:25:21,239 - INFO -   decoder_upsample_layers: 3
2025-06-03 22:25:21,239 - INFO -   epochs: 1000
2025-06-03 22:25:21,240 - INFO -   batch_size: 8
2025-06-03 22:25:21,240 - INFO -   learning_rate: 0.0001
2025-06-03 22:25:21,240 - INFO -   weight_decay: 1e-05
2025-06-03 22:25:21,240 - INFO -   clip_max_norm: 1.0
2025-06-03 22:25:21,240 - INFO -   seed: 42
2025-06-03 22:25:21,240 - INFO -   num_workers: 2
2025-06-03 22:25:21,240 - INFO -   use_amp: True
2025-06-03 22:25:21,240 - INFO -   bitstream_calc_freq: 200
2025-06-03 22:25:21,240 - INFO -   phase1_epochs: 30
2025-06-03 22:25:21,241 - INFO -   phase3_start_epoch: 97
2025-06-03 22:25:21,241 - INFO -   lambda_mse_flow: 10.0
2025-06-03 22:25:21,241 - INFO -   lambda_mse_residual: 15000.0
2025-06-03 22:25:21,241 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 22:25:21,241 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 22:25:21,241 - INFO -   lambda_msssim_phase3: 50.0
2025-06-03 22:25:21,241 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 22:25:21,241 - INFO -   freeze_mcn_phase1: True
2025-06-03 22:25:21,242 - INFO -   device: cuda
2025-06-03 22:25:21,242 - INFO - ------------------------------------------------------------
2025-06-03 22:25:21,242 - INFO - Setting up dataset...
2025-06-03 22:25:21,242 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 22:25:21,655 - INFO - Found 21000 potential frame files.
2025-06-03 22:25:21,656 - INFO - Grouping frames by directory...
2025-06-03 22:25:21,736 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 22:25:22,525 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 22:25:22,535 - INFO - Dataset loaded: 18000 pairs. DataLoader: 2250 batches.
2025-06-03 22:25:22,535 - INFO - Initializing Video Codec model...
2025-06-03 22:25:22,818 - INFO - Using a single GPU or CPU.
2025-06-03 22:25:22,818 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 22:25:22,818 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:25:22,818 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:25:22,818 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 22:25:22,975 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 22:25:23,184 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 22:25:23,241 - INFO - Loading optimizer state...
2025-06-03 22:25:23,242 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 22:25:23,242 - INFO - Loading GradScaler state...
2025-06-03 22:25:23,242 - INFO - GradScaler state loaded successfully.
2025-06-03 22:25:23,242 - INFO - Checkpoint loaded. Resuming from Epoch 98. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 22:25:23,243 - INFO - Resumed successfully. Training from Epoch 99. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 22:25:23,245 - INFO - --- Starting Training Loop from Epoch 99 up to 1000 ---
2025-06-03 22:25:23,246 - INFO - 
-------------------- Starting Epoch 99/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 22:25:23,246 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 22:25:23,247 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 22:25:23,247 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 22:27:01,404 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 22:28:30,598 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 22:30:00,067 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 22:31:29,667 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 22:32:58,989 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 22:34:28,142 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 22:35:57,399 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 22:37:26,655 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 22:38:55,908 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 22:40:25,242 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 22:41:54,498 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 22:42:17,576 - INFO - ------------------------------------------------------------
2025-06-03 22:42:17,577 - INFO - Epoch 99/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1014.33s
2025-06-03 22:42:17,577 - INFO -   Avg Loss: 23.46538
2025-06-03 22:42:17,577 - INFO -   Avg MS-SSIM (opt): 0.97815
2025-06-03 22:42:17,578 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000491
2025-06-03 22:42:17,578 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 3.00244
2025-06-03 22:42:17,578 - INFO - ------------------------------------------------------------
2025-06-03 22:42:17,579 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:42:17,959 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:42:19,849 - INFO - 
-------------------- Starting Epoch 100/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 22:43:58,639 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 22:45:27,746 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 22:46:57,071 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 22:48:26,465 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 22:49:55,888 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 22:51:25,201 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 22:52:54,542 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 22:54:23,912 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 22:55:53,287 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 22:57:22,547 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 22:58:51,968 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 22:59:15,072 - INFO - ------------------------------------------------------------
2025-06-03 22:59:15,073 - INFO - Epoch 100/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1015.22s
2025-06-03 22:59:15,073 - INFO -   Avg Loss: 23.96546
2025-06-03 22:59:15,074 - INFO -   Avg MS-SSIM (opt): 0.97775
2025-06-03 22:59:15,074 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000503
2025-06-03 22:59:15,075 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 3.06172
2025-06-03 22:59:15,075 - INFO - ------------------------------------------------------------
2025-06-03 22:59:15,077 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:59:15,448 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 22:59:17,040 - INFO - 
-------------------- Starting Epoch 101/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 23:00:55,709 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 23:02:25,031 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 23:03:54,418 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 23:05:23,672 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 23:06:52,857 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 23:08:21,938 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 23:09:05,129 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-03 23:10:23,699 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-03 23:10:23,699 - INFO - Configuration:
2025-06-03 23:10:23,699 - INFO -   frame_base_dir: ./sequence
2025-06-03 23:10:23,699 - INFO -   flow_base_dir: ./generated_flow
2025-06-03 23:10:23,699 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-03 23:10:23,699 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-03 23:10:23,699 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-03 23:10:23,699 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-03 23:10:23,699 - INFO -   motion_latent_channels: 128
2025-06-03 23:10:23,699 - INFO -   residual_latent_channels: 192
2025-06-03 23:10:23,699 - INFO -   mcn_base_channels: 32
2025-06-03 23:10:23,699 - INFO -   encoder_base_channels: 64
2025-06-03 23:10:23,699 - INFO -   encoder_res_blocks: 2
2025-06-03 23:10:23,699 - INFO -   encoder_downsample_layers: 3
2025-06-03 23:10:23,704 - INFO -   decoder_res_blocks: 2
2025-06-03 23:10:23,704 - INFO -   decoder_upsample_layers: 3
2025-06-03 23:10:23,704 - INFO -   epochs: 1000
2025-06-03 23:10:23,704 - INFO -   batch_size: 8
2025-06-03 23:10:23,704 - INFO -   learning_rate: 0.0001
2025-06-03 23:10:23,704 - INFO -   weight_decay: 1e-05
2025-06-03 23:10:23,704 - INFO -   clip_max_norm: 1.0
2025-06-03 23:10:23,704 - INFO -   seed: 42
2025-06-03 23:10:23,704 - INFO -   num_workers: 2
2025-06-03 23:10:23,704 - INFO -   use_amp: True
2025-06-03 23:10:23,705 - INFO -   bitstream_calc_freq: 200
2025-06-03 23:10:23,705 - INFO -   phase1_epochs: 30
2025-06-03 23:10:23,705 - INFO -   phase3_start_epoch: 97
2025-06-03 23:10:23,705 - INFO -   lambda_mse_flow: 10.0
2025-06-03 23:10:23,705 - INFO -   lambda_mse_residual: 15000.0
2025-06-03 23:10:23,705 - INFO -   lambda_bpp_motion: 1.0
2025-06-03 23:10:23,705 - INFO -   lambda_bpp_residual: 5.0
2025-06-03 23:10:23,705 - INFO -   lambda_msssim_phase3: 5.0
2025-06-03 23:10:23,705 - INFO -   learning_rate_phase3: 1e-05
2025-06-03 23:10:23,705 - INFO -   freeze_mcn_phase1: True
2025-06-03 23:10:23,705 - INFO -   device: cuda
2025-06-03 23:10:23,705 - INFO - ------------------------------------------------------------
2025-06-03 23:10:23,706 - INFO - Setting up dataset...
2025-06-03 23:10:23,707 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-03 23:10:24,214 - INFO - Found 21000 potential frame files.
2025-06-03 23:10:24,214 - INFO - Grouping frames by directory...
2025-06-03 23:10:24,325 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-03 23:10:25,304 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-03 23:10:25,320 - INFO - Dataset loaded: 18000 pairs. DataLoader: 2250 batches.
2025-06-03 23:10:25,320 - INFO - Initializing Video Codec model...
2025-06-03 23:10:25,610 - INFO - Using a single GPU or CPU.
2025-06-03 23:10:25,611 - INFO - Model initialized (29,938,216 total parameters).
2025-06-03 23:10:25,612 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 23:10:25,612 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 23:10:25,612 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-03 23:10:25,787 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-03 23:10:26,061 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-03 23:10:26,116 - INFO - Loading optimizer state...
2025-06-03 23:10:26,116 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-03 23:10:26,116 - INFO - Loading GradScaler state...
2025-06-03 23:10:26,116 - INFO - GradScaler state loaded successfully.
2025-06-03 23:10:26,116 - INFO - Checkpoint loaded. Resuming from Epoch 100. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 23:10:26,117 - INFO - Resumed successfully. Training from Epoch 101. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-03 23:10:26,119 - INFO - --- Starting Training Loop from Epoch 101 up to 1000 ---
2025-06-03 23:10:26,120 - INFO - 
-------------------- Starting Epoch 101/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 23:10:26,121 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-03 23:10:26,121 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-03 23:10:26,121 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-03 23:12:05,827 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 23:13:35,208 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 23:15:05,102 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 23:16:34,949 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 23:18:04,664 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 23:19:34,162 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 23:21:03,767 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 23:22:33,227 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 23:24:02,685 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 23:25:32,041 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 23:27:01,443 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 23:27:24,708 - INFO - ------------------------------------------------------------
2025-06-03 23:27:24,708 - INFO - Epoch 101/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1018.59s
2025-06-03 23:27:24,708 - INFO -   Avg Loss: 7.01806
2025-06-03 23:27:24,709 - INFO -   Avg MS-SSIM (opt): 0.97976
2025-06-03 23:27:24,709 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000342
2025-06-03 23:27:24,709 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.35840
2025-06-03 23:27:24,710 - INFO - ------------------------------------------------------------
2025-06-03 23:27:24,712 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 23:27:25,063 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 23:27:26,914 - INFO - 
-------------------- Starting Epoch 102/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 23:29:06,445 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 23:30:35,693 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 23:32:05,024 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 23:33:34,347 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 23:35:03,576 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 23:36:32,792 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 23:38:02,054 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 23:39:31,307 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 23:41:00,573 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 23:42:29,762 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-03 23:43:58,967 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-03 23:44:22,028 - INFO - ------------------------------------------------------------
2025-06-03 23:44:22,028 - INFO - Epoch 102/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1015.11s
2025-06-03 23:44:22,029 - INFO -   Avg Loss: 7.02412
2025-06-03 23:44:22,029 - INFO -   Avg MS-SSIM (opt): 0.97853
2025-06-03 23:44:22,030 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000342
2025-06-03 23:44:22,030 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.35693
2025-06-03 23:44:22,030 - INFO - ------------------------------------------------------------
2025-06-03 23:44:22,032 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 23:44:22,397 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-03 23:44:23,981 - INFO - 
-------------------- Starting Epoch 103/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-03 23:46:02,601 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-03 23:47:31,869 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-03 23:49:01,769 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-03 23:50:32,686 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-03 23:52:03,991 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-03 23:53:35,103 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-03 23:55:06,128 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-03 23:56:36,447 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-03 23:58:07,641 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-03 23:59:39,152 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 00:01:10,869 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 00:01:34,772 - INFO - ------------------------------------------------------------
2025-06-04 00:01:34,772 - INFO - Epoch 103/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1030.79s
2025-06-04 00:01:34,773 - INFO -   Avg Loss: 7.36594
2025-06-04 00:01:34,773 - INFO -   Avg MS-SSIM (opt): 0.97735
2025-06-04 00:01:34,773 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000354
2025-06-04 00:01:34,774 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.38844
2025-06-04 00:01:34,774 - INFO - ------------------------------------------------------------
2025-06-04 00:01:34,776 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 00:01:35,139 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 00:01:37,195 - INFO - 
-------------------- Starting Epoch 104/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 00:03:20,760 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 00:04:51,513 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 00:06:22,379 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 00:07:53,560 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 00:09:23,165 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 00:10:52,601 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 00:12:22,009 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 00:13:52,459 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 00:15:23,531 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 00:16:54,256 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 00:18:26,604 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 00:18:50,628 - INFO - ------------------------------------------------------------
2025-06-04 00:18:50,629 - INFO - Epoch 104/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1033.43s
2025-06-04 00:18:50,629 - INFO -   Avg Loss: 7.80575
2025-06-04 00:18:50,629 - INFO -   Avg MS-SSIM (opt): 0.97886
2025-06-04 00:18:50,630 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000359
2025-06-04 00:18:50,630 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.46398
2025-06-04 00:18:50,630 - INFO - ------------------------------------------------------------
2025-06-04 00:18:50,633 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 00:18:50,994 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 00:18:52,990 - INFO - 
-------------------- Starting Epoch 105/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 00:20:36,033 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 00:22:08,042 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 00:23:40,747 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 00:25:13,617 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 00:26:45,618 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 00:28:17,414 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 00:29:49,303 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 00:31:21,332 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 00:32:54,105 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 00:34:26,850 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 00:35:59,456 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 00:36:23,377 - INFO - ------------------------------------------------------------
2025-06-04 00:36:23,377 - INFO - Epoch 105/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1050.39s
2025-06-04 00:36:23,377 - INFO -   Avg Loss: 7.91130
2025-06-04 00:36:23,377 - INFO -   Avg MS-SSIM (opt): 0.97729
2025-06-04 00:36:23,377 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000359
2025-06-04 00:36:23,377 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.48191
2025-06-04 00:36:23,377 - INFO - ------------------------------------------------------------
2025-06-04 00:36:23,388 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 00:36:23,772 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 00:36:25,278 - INFO - 
-------------------- Starting Epoch 106/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 00:36:41,136 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-04 01:28:45,655 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-04 01:28:45,655 - INFO - Configuration:
2025-06-04 01:28:45,655 - INFO -   frame_base_dir: ./sequence
2025-06-04 01:28:45,656 - INFO -   flow_base_dir: ./generated_flow
2025-06-04 01:28:45,656 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-04 01:28:45,656 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-04 01:28:45,656 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-04 01:28:45,656 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-04 01:28:45,657 - INFO -   motion_latent_channels: 128
2025-06-04 01:28:45,657 - INFO -   residual_latent_channels: 192
2025-06-04 01:28:45,657 - INFO -   mcn_base_channels: 32
2025-06-04 01:28:45,657 - INFO -   encoder_base_channels: 64
2025-06-04 01:28:45,657 - INFO -   encoder_res_blocks: 2
2025-06-04 01:28:45,658 - INFO -   encoder_downsample_layers: 3
2025-06-04 01:28:45,658 - INFO -   decoder_res_blocks: 2
2025-06-04 01:28:45,658 - INFO -   decoder_upsample_layers: 3
2025-06-04 01:28:45,658 - INFO -   epochs: 1000
2025-06-04 01:28:45,658 - INFO -   batch_size: 8
2025-06-04 01:28:45,659 - INFO -   learning_rate: 0.0001
2025-06-04 01:28:45,659 - INFO -   weight_decay: 1e-05
2025-06-04 01:28:45,659 - INFO -   clip_max_norm: 1.0
2025-06-04 01:28:45,659 - INFO -   seed: 42
2025-06-04 01:28:45,660 - INFO -   num_workers: 2
2025-06-04 01:28:45,660 - INFO -   use_amp: True
2025-06-04 01:28:45,660 - INFO -   bitstream_calc_freq: 200
2025-06-04 01:28:45,660 - INFO -   phase1_epochs: 30
2025-06-04 01:28:45,660 - INFO -   phase3_start_epoch: 97
2025-06-04 01:28:45,661 - INFO -   lambda_mse_flow: 10.0
2025-06-04 01:28:45,661 - INFO -   lambda_mse_residual: 15000.0
2025-06-04 01:28:45,661 - INFO -   lambda_bpp_motion: 1.0
2025-06-04 01:28:45,661 - INFO -   lambda_bpp_residual: 5.0
2025-06-04 01:28:45,662 - INFO -   lambda_msssim_phase3: 5.0
2025-06-04 01:28:45,662 - INFO -   learning_rate_phase3: 1e-05
2025-06-04 01:28:45,662 - INFO -   freeze_mcn_phase1: True
2025-06-04 01:28:45,662 - INFO -   device: cuda
2025-06-04 01:28:45,662 - INFO - ------------------------------------------------------------
2025-06-04 01:28:45,662 - INFO - Setting up dataset...
2025-06-04 01:28:45,662 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-04 01:28:46,124 - INFO - Found 21000 potential frame files.
2025-06-04 01:28:46,125 - INFO - Grouping frames by directory...
2025-06-04 01:28:46,227 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-04 01:28:47,135 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-04 01:28:47,145 - INFO - Dataset loaded: 18000 pairs. DataLoader: 2250 batches.
2025-06-04 01:28:47,145 - INFO - Initializing Video Codec model...
2025-06-04 01:28:47,425 - INFO - Using a single GPU or CPU.
2025-06-04 01:28:47,425 - INFO - Model initialized (29,938,216 total parameters).
2025-06-04 01:28:47,425 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 01:28:47,425 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 01:28:47,425 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-04 01:28:47,591 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-04 01:28:47,841 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-04 01:28:47,897 - INFO - Loading optimizer state...
2025-06-04 01:28:47,899 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-04 01:28:47,899 - INFO - Loading GradScaler state...
2025-06-04 01:28:47,899 - INFO - GradScaler state loaded successfully.
2025-06-04 01:28:47,899 - INFO - Checkpoint loaded. Resuming from Epoch 105. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-04 01:28:47,899 - INFO - Resumed successfully. Training from Epoch 106. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-04 01:28:47,903 - INFO - --- Starting Training Loop from Epoch 106 up to 1000 ---
2025-06-04 01:28:47,906 - INFO - 
-------------------- Starting Epoch 106/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 01:28:47,908 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-04 01:28:47,909 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-04 01:28:47,909 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-04 01:30:28,856 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 01:31:59,224 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 01:33:30,073 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 01:35:00,888 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 01:36:31,868 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 01:38:02,810 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 01:39:33,884 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 01:41:04,969 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 01:42:35,967 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 01:44:06,987 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 01:45:38,011 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 01:46:01,566 - INFO - ------------------------------------------------------------
2025-06-04 01:46:01,566 - INFO - Epoch 106/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1033.66s
2025-06-04 01:46:01,566 - INFO -   Avg Loss: 7.01865
2025-06-04 01:46:01,566 - INFO -   Avg MS-SSIM (opt): 0.97907
2025-06-04 01:46:01,566 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000339
2025-06-04 01:46:01,567 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.36564
2025-06-04 01:46:01,567 - INFO - ------------------------------------------------------------
2025-06-04 01:46:01,569 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 01:46:01,948 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 01:46:03,761 - INFO - 
-------------------- Starting Epoch 107/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 01:47:43,812 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 01:49:14,870 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 01:50:45,945 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 01:52:17,110 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 01:53:48,231 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 01:55:19,360 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 01:56:50,545 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 01:58:21,712 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 01:59:52,802 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 02:01:23,936 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 02:02:55,022 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 02:03:18,575 - INFO - ------------------------------------------------------------
2025-06-04 02:03:18,575 - INFO - Epoch 107/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1034.81s
2025-06-04 02:03:18,575 - INFO -   Avg Loss: 7.26406
2025-06-04 02:03:18,575 - INFO -   Avg MS-SSIM (opt): 0.97711
2025-06-04 02:03:18,575 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000344
2025-06-04 02:03:18,575 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.39674
2025-06-04 02:03:18,575 - INFO - ------------------------------------------------------------
2025-06-04 02:03:18,575 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:03:18,983 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:03:20,580 - INFO - 
-------------------- Starting Epoch 108/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 02:05:00,660 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 02:06:31,818 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 02:08:02,828 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 02:09:33,880 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 02:11:05,008 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 02:12:36,063 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 02:14:07,108 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 02:15:38,262 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 02:17:09,361 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 02:18:40,395 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 02:20:11,595 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 02:20:35,159 - INFO - ------------------------------------------------------------
2025-06-04 02:20:35,159 - INFO - Epoch 108/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1034.58s
2025-06-04 02:20:35,159 - INFO -   Avg Loss: 9.68280
2025-06-04 02:20:35,160 - INFO -   Avg MS-SSIM (opt): 0.97655
2025-06-04 02:20:35,160 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000379
2025-06-04 02:20:35,160 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.77669
2025-06-04 02:20:35,161 - INFO - ------------------------------------------------------------
2025-06-04 02:20:35,163 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:20:35,537 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:20:37,395 - INFO - 
-------------------- Starting Epoch 109/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 02:22:17,452 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 02:23:48,647 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 02:25:19,910 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 02:26:51,160 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 02:28:22,538 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 02:29:53,925 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 02:31:26,082 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 02:32:57,620 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 02:34:28,875 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 02:36:00,219 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 02:37:31,485 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 02:37:55,132 - INFO - ------------------------------------------------------------
2025-06-04 02:37:55,133 - INFO - Epoch 109/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.74s
2025-06-04 02:37:55,133 - INFO -   Avg Loss: 11.04032
2025-06-04 02:37:55,133 - INFO -   Avg MS-SSIM (opt): 0.97642
2025-06-04 02:37:55,133 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000384
2025-06-04 02:37:55,134 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 1.03274
2025-06-04 02:37:55,134 - INFO - ------------------------------------------------------------
2025-06-04 02:37:55,134 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:37:55,515 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:37:57,357 - INFO - 
-------------------- Starting Epoch 110/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 02:39:37,805 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 02:41:09,033 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 02:42:40,278 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 02:44:11,554 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 02:45:42,760 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 02:47:14,160 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 02:48:45,549 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 02:50:16,910 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 02:51:48,330 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 02:53:19,600 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 02:54:50,939 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 02:55:14,456 - INFO - ------------------------------------------------------------
2025-06-04 02:55:14,456 - INFO - Epoch 110/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.10s
2025-06-04 02:55:14,456 - INFO -   Avg Loss: 9.10904
2025-06-04 02:55:14,471 - INFO -   Avg MS-SSIM (opt): 0.97737
2025-06-04 02:55:14,471 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000369
2025-06-04 02:55:14,471 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.69087
2025-06-04 02:55:14,471 - INFO - ------------------------------------------------------------
2025-06-04 02:55:14,475 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:55:14,890 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 02:55:16,350 - INFO - 
-------------------- Starting Epoch 111/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 02:56:56,700 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 02:58:27,965 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 02:59:59,381 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 03:01:30,740 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 03:03:02,138 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 03:04:33,541 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 03:06:04,906 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 03:07:36,395 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 03:09:07,680 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 03:10:39,073 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 03:12:10,498 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 03:12:34,140 - INFO - ------------------------------------------------------------
2025-06-04 03:12:34,140 - INFO - Epoch 111/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.79s
2025-06-04 03:12:34,140 - INFO -   Avg Loss: 8.03913
2025-06-04 03:12:34,141 - INFO -   Avg MS-SSIM (opt): 0.97723
2025-06-04 03:12:34,141 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000368
2025-06-04 03:12:34,142 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.48151
2025-06-04 03:12:34,142 - INFO - ------------------------------------------------------------
2025-06-04 03:12:34,145 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 03:12:34,515 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 03:12:36,166 - INFO - 
-------------------- Starting Epoch 112/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 03:14:16,813 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 03:15:48,202 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 03:17:19,602 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 03:18:51,018 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 03:20:22,446 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 03:21:53,949 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 03:23:25,314 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 03:24:56,599 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 03:26:28,022 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 03:27:59,392 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 03:29:30,714 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 03:29:54,257 - INFO - ------------------------------------------------------------
2025-06-04 03:29:54,258 - INFO - Epoch 112/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1038.09s
2025-06-04 03:29:54,258 - INFO -   Avg Loss: 8.04207
2025-06-04 03:29:54,258 - INFO -   Avg MS-SSIM (opt): 0.97788
2025-06-04 03:29:54,258 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000363
2025-06-04 03:29:54,258 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.49653
2025-06-04 03:29:54,258 - INFO - ------------------------------------------------------------
2025-06-04 03:29:54,260 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 03:29:54,630 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 03:29:55,995 - INFO - 
-------------------- Starting Epoch 113/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 03:31:36,285 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 03:33:07,524 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 03:34:39,295 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 03:36:11,218 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 03:37:42,735 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 03:39:14,158 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 03:40:45,810 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 03:42:17,407 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 03:43:48,944 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 03:45:20,545 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 03:46:52,013 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 03:47:15,742 - INFO - ------------------------------------------------------------
2025-06-04 03:47:15,743 - INFO - Epoch 113/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1039.75s
2025-06-04 03:47:15,743 - INFO -   Avg Loss: 10.60363
2025-06-04 03:47:15,743 - INFO -   Avg MS-SSIM (opt): 0.97618
2025-06-04 03:47:15,744 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000382
2025-06-04 03:47:15,744 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.95034
2025-06-04 03:47:15,744 - INFO - ------------------------------------------------------------
2025-06-04 03:47:15,745 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 03:47:16,088 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 03:47:17,904 - INFO - 
-------------------- Starting Epoch 114/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 03:49:06,631 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 03:50:38,766 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 03:52:10,443 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 03:53:42,162 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 03:55:14,011 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 03:56:45,774 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 03:58:17,604 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 03:59:49,345 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 04:01:21,271 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 04:02:52,995 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 04:04:24,903 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 04:04:48,648 - INFO - ------------------------------------------------------------
2025-06-04 04:04:48,649 - INFO - Epoch 114/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1050.74s
2025-06-04 04:04:48,649 - INFO -   Avg Loss: 11.28771
2025-06-04 04:04:48,649 - INFO -   Avg MS-SSIM (opt): 0.97737
2025-06-04 04:04:48,650 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000390
2025-06-04 04:04:48,650 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 1.06394
2025-06-04 04:04:48,650 - INFO - ------------------------------------------------------------
2025-06-04 04:04:48,652 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:04:49,025 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:04:50,932 - INFO - 
-------------------- Starting Epoch 115/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 04:06:39,260 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 04:08:10,756 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 04:09:42,286 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 04:11:13,943 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 04:12:45,485 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 04:14:17,030 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 04:15:48,581 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 04:17:20,082 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 04:18:51,471 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 04:20:22,814 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 04:21:54,184 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 04:22:17,799 - INFO - ------------------------------------------------------------
2025-06-04 04:22:17,800 - INFO - Epoch 115/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1046.87s
2025-06-04 04:22:17,800 - INFO -   Avg Loss: 14.67724
2025-06-04 04:22:17,800 - INFO -   Avg MS-SSIM (opt): 0.97690
2025-06-04 04:22:17,801 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000382
2025-06-04 04:22:17,801 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 1.76556
2025-06-04 04:22:17,801 - INFO - ------------------------------------------------------------
2025-06-04 04:22:17,803 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:22:18,188 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:22:20,095 - INFO - 
-------------------- Starting Epoch 116/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 04:24:00,486 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 04:25:31,806 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 04:27:03,095 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 04:28:34,294 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 04:30:05,627 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 04:31:36,932 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 04:33:08,182 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 04:34:39,560 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 04:36:10,944 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 04:37:42,135 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 04:39:13,564 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 04:39:37,231 - INFO - ------------------------------------------------------------
2025-06-04 04:39:37,231 - INFO - Epoch 116/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.13s
2025-06-04 04:39:37,231 - INFO -   Avg Loss: 97.77128
2025-06-04 04:39:37,231 - INFO -   Avg MS-SSIM (opt): 0.97321
2025-06-04 04:39:37,231 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000437
2025-06-04 04:39:37,232 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 18.21641
2025-06-04 04:39:37,232 - INFO - ------------------------------------------------------------
2025-06-04 04:39:37,234 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:39:37,602 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:39:39,389 - INFO - 
-------------------- Starting Epoch 117/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 04:41:19,706 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 04:42:50,830 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 04:44:22,107 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 04:45:53,506 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 04:47:24,755 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 04:48:56,106 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 04:50:27,487 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 04:51:58,896 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 04:53:30,336 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 04:55:01,689 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 04:56:33,193 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 04:56:56,803 - INFO - ------------------------------------------------------------
2025-06-04 04:56:56,803 - INFO - Epoch 117/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.41s
2025-06-04 04:56:56,804 - INFO -   Avg Loss: 12.07107
2025-06-04 04:56:56,804 - INFO -   Avg MS-SSIM (opt): 0.97604
2025-06-04 04:56:56,804 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000410
2025-06-04 04:56:56,805 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 1.16006
2025-06-04 04:56:56,805 - INFO - ------------------------------------------------------------
2025-06-04 04:56:56,807 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:56:57,196 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 04:56:59,023 - INFO - 
-------------------- Starting Epoch 118/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 04:58:39,517 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 05:00:10,841 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 05:01:42,217 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 05:03:13,423 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 05:04:44,820 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 05:06:16,215 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 05:07:47,581 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 05:09:18,918 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 05:10:50,261 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 05:12:21,636 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 05:13:53,057 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 05:14:16,629 - INFO - ------------------------------------------------------------
2025-06-04 05:14:16,629 - INFO - Epoch 118/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.61s
2025-06-04 05:14:16,630 - INFO -   Avg Loss: 12.19116
2025-06-04 05:14:16,630 - INFO -   Avg MS-SSIM (opt): 0.97516
2025-06-04 05:14:16,630 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000421
2025-06-04 05:14:16,630 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 1.15113
2025-06-04 05:14:16,630 - INFO - ------------------------------------------------------------
2025-06-04 05:14:16,632 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 05:14:17,005 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 05:14:18,406 - INFO - 
-------------------- Starting Epoch 119/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 05:15:58,747 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 05:17:30,043 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 05:19:01,333 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 05:20:32,625 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 05:22:04,023 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 05:23:35,332 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 05:25:06,719 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 05:26:38,087 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 05:28:09,487 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 05:29:40,969 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 05:31:12,436 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 05:31:36,102 - INFO - ------------------------------------------------------------
2025-06-04 05:31:36,102 - INFO - Epoch 119/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.70s
2025-06-04 05:31:36,104 - INFO -   Avg Loss: 12.79110
2025-06-04 05:31:36,104 - INFO -   Avg MS-SSIM (opt): 0.97434
2025-06-04 05:31:36,104 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000435
2025-06-04 05:31:36,104 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 1.22779
2025-06-04 05:31:36,105 - INFO - ------------------------------------------------------------
2025-06-04 05:31:36,107 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 05:31:36,498 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 05:31:38,281 - INFO - 
-------------------- Starting Epoch 120/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 05:33:18,867 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 05:34:50,163 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 05:36:21,644 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 05:37:53,168 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 05:39:24,640 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 05:40:56,046 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 05:42:27,469 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 05:43:58,962 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 05:45:30,508 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 05:47:01,996 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 05:48:33,466 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 05:48:57,030 - INFO - ------------------------------------------------------------
2025-06-04 05:48:57,030 - INFO - Epoch 120/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1038.75s
2025-06-04 05:48:57,031 - INFO -   Avg Loss: 10.90095
2025-06-04 05:48:57,031 - INFO -   Avg MS-SSIM (opt): 0.97560
2025-06-04 05:48:57,031 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000418
2025-06-04 05:48:57,032 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.90128
2025-06-04 05:48:57,032 - INFO - ------------------------------------------------------------
2025-06-04 05:48:57,034 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 05:48:57,409 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 05:48:59,100 - INFO - 
-------------------- Starting Epoch 121/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 05:50:39,720 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 05:52:11,217 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 05:53:42,746 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 05:55:14,311 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 05:56:45,837 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 05:58:17,289 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 05:59:48,696 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 06:01:20,218 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 06:02:51,754 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 06:04:23,171 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 06:05:54,660 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 06:06:18,351 - INFO - ------------------------------------------------------------
2025-06-04 06:06:18,351 - INFO - Epoch 121/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1039.25s
2025-06-04 06:06:18,352 - INFO -   Avg Loss: 9.19296
2025-06-04 06:06:18,352 - INFO -   Avg MS-SSIM (opt): 0.97571
2025-06-04 06:06:18,352 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000406
2025-06-04 06:06:18,353 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.59535
2025-06-04 06:06:18,353 - INFO - ------------------------------------------------------------
2025-06-04 06:06:18,355 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 06:06:18,732 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 06:06:20,166 - INFO - 
-------------------- Starting Epoch 122/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 06:08:00,420 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 06:09:31,764 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 06:11:03,025 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 06:12:34,243 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 06:14:05,555 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 06:15:36,953 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 06:17:08,295 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 06:18:39,808 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 06:20:11,198 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 06:21:42,645 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 06:23:14,099 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 06:23:37,729 - INFO - ------------------------------------------------------------
2025-06-04 06:23:37,729 - INFO - Epoch 122/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1037.56s
2025-06-04 06:23:37,729 - INFO -   Avg Loss: 11.47485
2025-06-04 06:23:37,730 - INFO -   Avg MS-SSIM (opt): 0.97384
2025-06-04 06:23:37,730 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000431
2025-06-04 06:23:37,730 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.97574
2025-06-04 06:23:37,731 - INFO - ------------------------------------------------------------
2025-06-04 06:23:37,732 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 06:23:38,105 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 06:23:39,604 - INFO - 
-------------------- Starting Epoch 123/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 06:25:20,103 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 06:26:51,528 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 06:28:23,267 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 06:29:23,604 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
2025-06-04 19:49:32,151 - INFO - ============================================================
Starting Training Session (3-Phase - ResAE only in P3)
============================================================
2025-06-04 19:49:32,151 - INFO - Configuration:
2025-06-04 19:49:32,152 - INFO -   frame_base_dir: ./sequence
2025-06-04 19:49:32,152 - INFO -   flow_base_dir: ./generated_flow
2025-06-04 19:49:32,152 - INFO -   checkpoint_dir: ./codec_checkpoints_2phase_visual
2025-06-04 19:49:32,152 - INFO -   vis_dir: ./codec_visualizations_3phase_resAE_vis
2025-06-04 19:49:32,152 - INFO -   log_file: training_log_3phase_resAE_vis.txt
2025-06-04 19:49:32,152 - INFO -   latest_checkpoint_file: latest_checkpoint_3phase.pth.tar
2025-06-04 19:49:32,152 - INFO -   motion_latent_channels: 128
2025-06-04 19:49:32,153 - INFO -   residual_latent_channels: 192
2025-06-04 19:49:32,153 - INFO -   mcn_base_channels: 32
2025-06-04 19:49:32,153 - INFO -   encoder_base_channels: 64
2025-06-04 19:49:32,153 - INFO -   encoder_res_blocks: 2
2025-06-04 19:49:32,153 - INFO -   encoder_downsample_layers: 3
2025-06-04 19:49:32,153 - INFO -   decoder_res_blocks: 2
2025-06-04 19:49:32,153 - INFO -   decoder_upsample_layers: 3
2025-06-04 19:49:32,153 - INFO -   epochs: 1000
2025-06-04 19:49:32,153 - INFO -   batch_size: 8
2025-06-04 19:49:32,153 - INFO -   learning_rate: 0.0001
2025-06-04 19:49:32,153 - INFO -   weight_decay: 1e-05
2025-06-04 19:49:32,154 - INFO -   clip_max_norm: 1.0
2025-06-04 19:49:32,154 - INFO -   seed: 42
2025-06-04 19:49:32,154 - INFO -   num_workers: 2
2025-06-04 19:49:32,154 - INFO -   use_amp: True
2025-06-04 19:49:32,154 - INFO -   bitstream_calc_freq: 200
2025-06-04 19:49:32,154 - INFO -   phase1_epochs: 30
2025-06-04 19:49:32,154 - INFO -   phase3_start_epoch: 97
2025-06-04 19:49:32,154 - INFO -   lambda_mse_flow: 10.0
2025-06-04 19:49:32,154 - INFO -   lambda_mse_residual: 15000.0
2025-06-04 19:49:32,154 - INFO -   lambda_bpp_motion: 1.0
2025-06-04 19:49:32,154 - INFO -   lambda_bpp_residual: 5.0
2025-06-04 19:49:32,155 - INFO -   lambda_msssim_phase3: 5.0
2025-06-04 19:49:32,155 - INFO -   learning_rate_phase3: 1e-05
2025-06-04 19:49:32,155 - INFO -   freeze_mcn_phase1: True
2025-06-04 19:49:32,155 - INFO -   device: cuda
2025-06-04 19:49:32,155 - INFO - ------------------------------------------------------------
2025-06-04 19:49:32,155 - INFO - Setting up dataset...
2025-06-04 19:49:32,156 - INFO - Scanning for frames in: C:\Users\Anis\Desktop\XX\sequence with suffix .png
2025-06-04 19:49:32,559 - INFO - Found 21000 potential frame files.
2025-06-04 19:49:32,560 - INFO - Grouping frames by directory...
2025-06-04 19:49:32,649 - INFO - Checking 3000 directories for valid frame pairs and flow files...
2025-06-04 19:49:33,999 - INFO - Dataset Scan Complete: Found 18000 valid frame/flow pairs out of 18000 potential pairs checked.
2025-06-04 19:49:34,008 - INFO - Dataset loaded: 18000 pairs. DataLoader: 2250 batches.
2025-06-04 19:49:34,009 - INFO - Initializing Video Codec model...
2025-06-04 19:49:34,268 - INFO - Using a single GPU or CPU.
2025-06-04 19:49:34,269 - INFO - Model initialized (29,938,216 total parameters).
2025-06-04 19:49:34,269 - INFO - Checking for checkpoint at: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 19:49:34,270 - INFO - Found potential checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 19:49:34,270 - INFO - Loading checkpoint: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar to device: cuda
2025-06-04 19:49:34,528 - INFO - Updating entropy bottlenecks before loading state dict (calling .update(force=True))...
2025-06-04 19:49:34,915 - INFO - Entropy bottlenecks .update(force=True) called.
2025-06-04 19:49:34,973 - INFO - Loading optimizer state...
2025-06-04 19:49:34,974 - WARNING - Warning: Could not load optimizer state properly due to other error: loaded state dict contains a parameter group that doesn't match the size of optimizer's group
2025-06-04 19:49:34,974 - INFO - Loading GradScaler state...
2025-06-04 19:49:34,974 - INFO - GradScaler state loaded successfully.
2025-06-04 19:49:34,974 - INFO - Checkpoint loaded. Resuming from Epoch 122. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-04 19:49:34,975 - INFO - Resumed successfully. Training from Epoch 123. Optimizer mode was 'phase3_residual_ae_only'.
2025-06-04 19:49:34,976 - INFO - --- Starting Training Loop from Epoch 123 up to 1000 ---
2025-06-04 19:49:34,978 - INFO - 
-------------------- Starting Epoch 123/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 19:49:34,978 - INFO - Configuring optimizer for mode 'phase3_residual_ae_only' with LR 1e-05.
2025-06-04 19:49:34,978 - INFO - Reset GradScaler for new optimizer configuration.
2025-06-04 19:49:34,979 - INFO - Optimizer configured. Trainable parameters: 23,773,955
2025-06-04 19:51:12,588 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 19:52:40,148 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 19:54:08,385 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 19:55:36,481 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 19:57:04,929 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 19:58:31,827 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 19:59:59,885 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 20:01:28,044 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 20:02:56,351 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 20:04:24,819 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 20:05:52,857 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 20:06:15,671 - INFO - ------------------------------------------------------------
2025-06-04 20:06:15,671 - INFO - Epoch 123/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 1000.69s
2025-06-04 20:06:15,671 - INFO -   Avg Loss: 8.77022
2025-06-04 20:06:15,671 - INFO -   Avg MS-SSIM (opt): 0.97684
2025-06-04 20:06:15,671 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000406
2025-06-04 20:06:15,671 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.51344
2025-06-04 20:06:15,671 - INFO - ------------------------------------------------------------
2025-06-04 20:06:15,687 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:06:16,027 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:06:17,869 - INFO - 
-------------------- Starting Epoch 124/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 20:07:54,757 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 20:09:22,587 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 20:10:50,373 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 20:12:18,253 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 20:13:46,151 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 20:15:13,964 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 20:16:41,883 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 20:18:09,733 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 20:19:37,556 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 20:21:05,262 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 20:22:33,043 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 20:22:55,696 - INFO - ------------------------------------------------------------
2025-06-04 20:22:55,696 - INFO - Epoch 124/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 997.83s
2025-06-04 20:22:55,696 - INFO -   Avg Loss: 8.26295
2025-06-04 20:22:55,696 - INFO -   Avg MS-SSIM (opt): 0.97656
2025-06-04 20:22:55,696 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000384
2025-06-04 20:22:55,696 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.47616
2025-06-04 20:22:55,696 - INFO - ------------------------------------------------------------
2025-06-04 20:22:55,696 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:22:56,130 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:22:57,684 - INFO - 
-------------------- Starting Epoch 125/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 20:24:34,275 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 20:26:01,820 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 20:27:29,533 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 20:28:57,320 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 20:30:25,082 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 20:31:52,843 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 20:33:20,667 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 20:34:48,490 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 20:36:16,297 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 20:37:44,054 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 20:39:11,836 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 20:39:34,471 - INFO - ------------------------------------------------------------
2025-06-04 20:39:34,471 - INFO - Epoch 125/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 996.79s
2025-06-04 20:39:34,471 - INFO -   Avg Loss: 9.21271
2025-06-04 20:39:34,471 - INFO -   Avg MS-SSIM (opt): 0.97599
2025-06-04 20:39:34,471 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000395
2025-06-04 20:39:34,471 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.63210
2025-06-04 20:39:34,471 - INFO - ------------------------------------------------------------
2025-06-04 20:39:34,471 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:39:34,847 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:39:36,668 - INFO - 
-------------------- Starting Epoch 126/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 20:41:13,392 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 20:42:40,963 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 20:44:08,609 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 20:45:36,383 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 20:47:04,127 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 20:48:31,922 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 20:49:59,687 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 20:51:27,536 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 20:52:55,424 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 20:54:23,312 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 20:55:51,190 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 20:56:13,901 - INFO - ------------------------------------------------------------
2025-06-04 20:56:13,901 - INFO - Epoch 126/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 997.23s
2025-06-04 20:56:13,901 - INFO -   Avg Loss: 9.33294
2025-06-04 20:56:13,901 - INFO -   Avg MS-SSIM (opt): 0.97679
2025-06-04 20:56:13,901 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000394
2025-06-04 20:56:13,901 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.66003
2025-06-04 20:56:13,901 - INFO - ------------------------------------------------------------
2025-06-04 20:56:13,901 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:56:14,267 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 20:56:16,042 - INFO - 
-------------------- Starting Epoch 127/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 20:57:52,905 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 20:59:20,609 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 21:00:48,335 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 21:02:16,118 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 21:03:43,858 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 21:05:11,642 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1200: too many values to unpack (expected 2)
2025-06-04 21:06:39,477 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1400: too many values to unpack (expected 2)
2025-06-04 21:08:07,299 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1600: too many values to unpack (expected 2)
2025-06-04 21:09:35,116 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1800: too many values to unpack (expected 2)
2025-06-04 21:11:02,849 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2000: too many values to unpack (expected 2)
2025-06-04 21:12:30,662 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 2200: too many values to unpack (expected 2)
2025-06-04 21:12:53,299 - INFO - ------------------------------------------------------------
2025-06-04 21:12:53,299 - INFO - Epoch 127/1000 Summary (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) | Time: 997.26s
2025-06-04 21:12:53,299 - INFO -   Avg Loss: 10.30253
2025-06-04 21:12:53,299 - INFO -   Avg MS-SSIM (opt): 0.97583
2025-06-04 21:12:53,299 - INFO -   Avg MSE_Flow (mon): 0.797697 | MSE_Res (opt): 0.000398
2025-06-04 21:12:53,299 - INFO -   Avg BPP_M(est,mon): 0.38066 | BPP_R(est,opt): 0.84361
2025-06-04 21:12:53,299 - INFO - ------------------------------------------------------------
2025-06-04 21:12:53,301 - INFO - Attempting to save checkpoint to: ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 21:12:53,660 - INFO - Checkpoint successfully saved to ./codec_checkpoints_2phase_visual\latest_checkpoint_3phase.pth.tar
2025-06-04 21:12:55,086 - INFO - 
-------------------- Starting Epoch 128/1000 (Phase 3 (Train: ResAE Only | MS-SSIM, MSE_Res, BPP_Res)) --------------------
2025-06-04 21:14:31,812 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 200: too many values to unpack (expected 2)
2025-06-04 21:15:59,619 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 400: too many values to unpack (expected 2)
2025-06-04 21:17:27,485 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 600: too many values to unpack (expected 2)
2025-06-04 21:18:55,271 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 800: too many values to unpack (expected 2)
2025-06-04 21:20:23,055 - WARNING - Warning: Bitstream calculation (compress) failed at Batch 1000: too many values to unpack (expected 2)
2025-06-04 21:20:58,936 - WARNING - 
--- Training Interrupted by User (KeyboardInterrupt) ---
