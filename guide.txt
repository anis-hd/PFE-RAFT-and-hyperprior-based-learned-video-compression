use new_train and codec_processing